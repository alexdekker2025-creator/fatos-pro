# –î–æ–∫—É–º–µ–Ω—Ç –¥–∏–∑–∞–π–Ω–∞: –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –∞—Ä–∫–∞–Ω–æ–≤

## –û–±–∑–æ—Ä

–î–∞–Ω–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –¥–∏–∑–∞–π–Ω –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã –∞—Ä–∫–∞–Ω–æ–≤ –Ω–∞ —Å–∞–π—Ç–µ –Ω—É–º–µ—Ä–æ–ª–æ–≥–∏–∏ fatos.pro. –°–∏—Å—Ç–µ–º–∞ –≤–∫–ª—é—á–∞–µ—Ç —á–µ—Ç—ã—Ä–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞:

1. **–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞—Ä–∫–∞–Ω–æ–≤ –≤ –ø–æ–ª–Ω–æ—á—å** - –º–µ—Ö–∞–Ω–∏–∑–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–µ—Ä–µ—Å—á–µ—Ç–∞ –∞—Ä–∫–∞–Ω–æ–≤ –£—Ç—Ä–æ, –î–µ–Ω—å, –í–µ—á–µ—Ä –∏ –ù–æ—á—å –ø—Ä–∏ —Å–º–µ–Ω–µ –¥–∞—Ç—ã
2. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø—Ä–æ—Ñ–∏–ª–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–º–µ–Ω–∏
3. **–ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–µ–π –∞—Ä–∫–∞–Ω–æ–≤** - –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –æ–ø–∏—Å–∞–Ω–∏—è–º–∏ 22 –∞—Ä–∫–∞–Ω–æ–≤ –¢–∞—Ä–æ –Ω–∞ –¥–≤—É—Ö —è–∑—ã–∫–∞—Ö
4. **–ü–∞—Ä—Å–µ—Ä –¥–∞–Ω–Ω—ã—Ö –∞—Ä–∫–∞–Ω–æ–≤** - —É—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –∞—Ä–∫–∞–Ω–æ–≤

## –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞—Å—á–µ—Ç–∞ 4 –∞—Ä–∫–∞–Ω–æ–≤ (–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û)

### –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
- **–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è**: DD.MM.YYYY
- **–¢–µ–∫—É—â–∞—è –¥–∞—Ç–∞**: DD.MM.YYYY  
- **–ò–º—è**: –ø–æ–ª–Ω–æ–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Ä—É—Å—Å–∫–∏–µ –∏–ª–∏ –∞–Ω–≥–ª–∏–π—Å–∫–∏–µ –±—É–∫–≤—ã)

### –®–∞–≥ 1: –†–∞—Å—á–µ—Ç —Å—É–º–º

**–°—É–º–º–∞ –¥–∞—Ç—ã —Ä–æ–∂–¥–µ–Ω–∏—è** (—Å –º–∞—Å—Ç–µ—Ä-—á–∏—Å–ª–∞–º–∏):
1. –°—É–º–º–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —Ü–∏—Ñ—Ä—ã –¥–∞—Ç—ã —Ä–æ–∂–¥–µ–Ω–∏—è: DD + MM + YYYY
2. –°–≤–æ–¥–∏—Ç—å –∫ –æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ–º—É —á–∏—Å–ª—É –ø—É—Ç–µ–º –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ —Å—É–º–º–∏—Ä–æ–≤–∞–Ω–∏—è —Ü–∏—Ñ—Ä
3. **–ò–°–ö–õ–Æ–ß–ï–ù–ò–ï**: –ï—Å–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç 11 –∏–ª–∏ 22, –û–°–¢–ê–ù–û–í–ò–¢–¨–°–Ø - —ç—Ç–æ –º–∞—Å—Ç–µ—Ä-—á–∏—Å–ª–∞, –ù–ï —Å–≤–æ–¥–∏—Ç—å –¥–∞–ª—å—à–µ
4. –ü—Ä–∏–º–µ—Ä: 13.12.1984 ‚Üí 1+3+1+2+1+9+8+4 = 29 ‚Üí 2+9 = 11 (–°–¢–û–ü, –º–∞—Å—Ç–µ—Ä-—á–∏—Å–ª–æ)

**–°—É–º–º–∞ —Ç–µ–∫—É—â–µ–π –¥–∞—Ç—ã** (—Å –º–∞—Å—Ç–µ—Ä-—á–∏—Å–ª–∞–º–∏):
1. –°—É–º–º–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —Ü–∏—Ñ—Ä—ã —Ç–µ–∫—É—â–µ–π –¥–∞—Ç—ã: DD + MM + YYYY
2. –°–≤–æ–¥–∏—Ç—å –∫ –æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ–º—É —á–∏—Å–ª—É –ø—É—Ç–µ–º –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ —Å—É–º–º–∏—Ä–æ–≤–∞–Ω–∏—è —Ü–∏—Ñ—Ä
3. **–ò–°–ö–õ–Æ–ß–ï–ù–ò–ï**: –ï—Å–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç 11 –∏–ª–∏ 22, –û–°–¢–ê–ù–û–í–ò–¢–¨–°–Ø - —ç—Ç–æ –º–∞—Å—Ç–µ—Ä-—á–∏—Å–ª–∞
4. –ü—Ä–∏–º–µ—Ä: 20.02.2026 ‚Üí 2+0+0+2+2+0+2+6 = 14 ‚Üí 1+4 = 5

**–°—É–º–º–∞ –∏–º–µ–Ω–∏** (–≤—Å–µ–≥–¥–∞ —Å–≤–æ–¥–∏—Ç—å –∫ –æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ–º—É):
1. –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –∫–∞–∂–¥—É—é –±—É–∫–≤—É –≤ —á–∏—Å–ª–æ –ø–æ —Ç–∞–±–ª–∏—Ü–µ
2. –°—É–º–º–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —á–∏—Å–ª–∞
3. –°–≤–æ–¥–∏—Ç—å –∫ –æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ–º—É —á–∏—Å–ª—É (–Ω–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏—è –¥–ª—è –º–∞—Å—Ç–µ—Ä-—á–∏—Å–µ–ª –≤ –∏–º–µ–Ω–∞—Ö)
4. –ü—Ä–∏–º–µ—Ä: –ê–ª–µ–∫—Å–µ–π ‚Üí 1+4+6+3+1+6+2 = 23 ‚Üí 2+3 = 5

**–¢–∞–±–ª–∏—Ü–∞ –±—É–∫–≤ (—Ä—É—Å—Å–∫–∏–π –∞–ª—Ñ–∞–≤–∏—Ç):**
```
1: –ê, –ë, –í, –ì, –î, –ï, –Å, –ñ, –ó
2: –ò, –ô, –ö, –õ, –ú, –ù, –û, –ü, –†
3: –°, –¢, –£, –§, –•, –¶, –ß, –®, –©
4: –™, –´, –¨, –≠, –Æ, –Ø
```

–î–ª—è –∞–Ω–≥–ª–∏–π—Å–∫–∏—Ö –±—É–∫–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –Ω—É–º–µ—Ä–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è —Ç–∞–±–ª–∏—Ü–∞ (A=1, B=2, ..., I=9, J=1, K=2, –∏ —Ç.–¥.)

### –®–∞–≥ 2: –†–∞—Å—á–µ—Ç 4 –∞—Ä–∫–∞–Ω–æ–≤

**üåÖ –ê—Ä–∫–∞–Ω –£—Ç—Ä–æ:**
```
–£—Ç—Ä–æ = (–°—É–º–º–∞ –¥–∞—Ç—ã —Ä–æ–∂–¥–µ–Ω–∏—è + –°—É–º–º–∞ —Ç–µ–∫—É—â–µ–π –¥–∞—Ç—ã) mod 22
–ï—Å–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç = 0, —Ç–æ –£—Ç—Ä–æ = 22
```

**‚òÄÔ∏è –ê—Ä–∫–∞–Ω –î–µ–Ω—å:**
```
–î–µ–Ω—å = (–°—É–º–º–∞ –¥–∞—Ç—ã —Ä–æ–∂–¥–µ–Ω–∏—è √ó –°—É–º–º–∞ —Ç–µ–∫—É—â–µ–π –¥–∞—Ç—ã) mod 22
–ï—Å–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç = 0, —Ç–æ –î–µ–Ω—å = 22
```

**üåá –ê—Ä–∫–∞–Ω –í–µ—á–µ—Ä:**
```
–í–µ—á–µ—Ä = (–°—É–º–º–∞ –∏–º–µ–Ω–∏ + –°—É–º–º–∞ —Ç–µ–∫—É—â–µ–π –¥–∞—Ç—ã) mod 22
–ï—Å–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç = 0, —Ç–æ –í–µ—á–µ—Ä = 22
```

**üåô –ê—Ä–∫–∞–Ω –ù–æ—á—å:**
```
–ù–æ—á—å = (–£—Ç—Ä–æ + –î–µ–Ω—å + –í–µ—á–µ—Ä) mod 22
–ï—Å–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç = 0, —Ç–æ –ù–æ—á—å = 22
```

**–ü—Ä–∞–≤–∏–ª–æ –ø—Ä–∏–≤–µ–¥–µ–Ω–∏—è:**
- –ï—Å–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç > 22: –≤—ã—á–∏—Ç–∞—Ç—å 22 –ø–æ–≤—Ç–æ—Ä–Ω–æ, –ø–æ–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–µ –≤–æ–π–¥–µ—Ç –≤ –¥–∏–∞–ø–∞–∑–æ–Ω 1-22
- –ï—Å–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç = 0: —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å 22
- –í–∞–ª–∏–¥–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω: 1-22 (–≤–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ)

### –ü—Ä–∏–º–µ—Ä —Ä–∞—Å—á–µ—Ç–∞:

**–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**
- –î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è: 13.12.1984
- –¢–µ–∫—É—â–∞—è –¥–∞—Ç–∞: 20.02.2026
- –ò–º—è: –ê–ª–µ–∫—Å–µ–π

**–®–∞–≥ 1:**
- –°—É–º–º–∞ –¥–∞—Ç—ã —Ä–æ–∂–¥–µ–Ω–∏—è: 1+3+1+2+1+9+8+4 = 29 ‚Üí 2+9 = 11 (–º–∞—Å—Ç–µ—Ä-—á–∏—Å–ª–æ, —Å—Ç–æ–ø)
- –°—É–º–º–∞ —Ç–µ–∫—É—â–µ–π –¥–∞—Ç—ã: 2+0+0+2+2+0+2+6 = 14 ‚Üí 1+4 = 5
- –°—É–º–º–∞ –∏–º–µ–Ω–∏: –ê(1)+–õ(4)+–ï(6)+–ö(3)+–°(1)+–ï(6)+–ô(2) = 23 ‚Üí 2+3 = 5

**–®–∞–≥ 2:**
- –£—Ç—Ä–æ: 11 + 5 = 16 ‚Üí **–ê—Ä–∫–∞–Ω 16 (–ë–∞—à–Ω—è)**
- –î–µ–Ω—å: 11 √ó 5 = 55 ‚Üí 55 - 22 = 33 ‚Üí 33 - 22 = 11 ‚Üí **–ê—Ä–∫–∞–Ω 11 (–°–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç—å)**
- –í–µ—á–µ—Ä: 5 + 5 = 10 ‚Üí **–ê—Ä–∫–∞–Ω 10 (–ö–æ–ª–µ—Å–æ –§–æ—Ä—Ç—É–Ω—ã)**
- –ù–æ—á—å: 16 + 11 + 10 = 37 ‚Üí 37 - 22 = 15 ‚Üí **–ê—Ä–∫–∞–Ω 15 (–î—å—è–≤–æ–ª)**

### –ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ—Ç –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞:

- **–£—Ç—Ä–æ**: –±—ã–ª–æ `—Ç–æ–ª—å–∫–æ –¥–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è` ‚Üí —Ç–µ–ø–µ—Ä—å `–¥–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è + —Ç–µ–∫—É—â–∞—è –¥–∞—Ç–∞`
- **–î–µ–Ω—å**: –±—ã–ª–æ `—Ç–æ–ª—å–∫–æ —Ç–µ–∫—É—â–∞—è –¥–∞—Ç–∞` ‚Üí —Ç–µ–ø–µ—Ä—å `–¥–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è √ó —Ç–µ–∫—É—â–∞—è –¥–∞—Ç–∞`
- **–í–µ—á–µ—Ä**: –±—ã–ª–æ `–∏–º—è + —É—Ç—Ä–æ + –¥–µ–Ω—å` ‚Üí —Ç–µ–ø–µ—Ä—å `–∏–º—è + —Ç–µ–∫—É—â–∞—è –¥–∞—Ç–∞`
- **–ù–æ—á—å**: –±—ã–ª–æ `–¥–µ–Ω—å + –≤–µ—á–µ—Ä` ‚Üí —Ç–µ–ø–µ—Ä—å `—É—Ç—Ä–æ + –¥–µ–Ω—å + –≤–µ—á–µ—Ä`
- **–£—Ç—Ä–æ –¢–ï–ü–ï–†–¨ –º–µ–Ω—è–µ—Ç—Å—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ** (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–µ–∫—É—â–µ–π –¥–∞—Ç—ã)

### –¶–µ–ª–∏ –¥–∏–∑–∞–π–Ω–∞

- –û–±–µ—Å–ø–µ—á–∏—Ç—å –±–µ—Å—à–æ–≤–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞—Ä–∫–∞–Ω–æ–≤ –±–µ–∑ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –£–ª—É—á—à–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç —á–µ—Ä–µ–∑ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—é (—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–º–µ–Ω–∏)
- –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –±–æ–≥–∞—Ç—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π –∞—Ä–∫–∞–Ω–æ–≤
- –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ —Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω—É—é —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—é
- **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º —Ä–∞—Å—á–µ—Ç–∞ 4 –∞—Ä–∫–∞–Ω–æ–≤ —Å —É—á–µ—Ç–æ–º –º–∞—Å—Ç–µ—Ä-—á–∏—Å–µ–ª –∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö —Ñ–æ—Ä–º—É–ª**

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

- –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–∞ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–π —Å—Ç–æ—Ä–æ–Ω–µ (—Ç—Ä–µ–±—É–µ—Ç—Å—è –æ—Ç–∫—Ä—ã—Ç–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞)
- –ò–º—è –≤ localStorage –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ fallback –¥–ª—è –Ω–µ–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- SQL —Å–∫—Ä–∏–ø—Ç –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º –∏–ª–∏ —á–µ—Ä–µ–∑ –º–∏–≥—Ä–∞—Ü–∏—é
- **–í—Å–µ 4 –∞—Ä–∫–∞–Ω–∞ –º–µ–Ω—è—é—Ç—Å—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ** (–≤—Å–µ –∑–∞–≤–∏—Å—è—Ç –æ—Ç —Ç–µ–∫—É—â–µ–π –¥–∞—Ç—ã –≤ –Ω–æ–≤–æ–º –∞–ª–≥–æ—Ä–∏—Ç–º–µ)


## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### High-Level –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                     Client (Browser)                         ‚îÇ
‚îÇ                                                              ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ
‚îÇ  ‚îÇ           Calculator Component                      ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  Midnight Check Timer (useEffect)        ‚îÇ     ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É                ‚îÇ     ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  - –°—Ä–∞–≤–Ω–µ–Ω–∏–µ lastCalculationDate         ‚îÇ     ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  - –¢—Ä–∏–≥–≥–µ—Ä –ø–µ—Ä–µ—Å—á–µ—Ç–∞ –ø—Ä–∏ —Å–º–µ–Ω–µ –¥–∞—Ç—ã      ‚îÇ     ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ                                                     ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  Name Management                          ‚îÇ     ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  - –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑ session/localStorage      ‚îÇ     ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  - –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏           ‚îÇ     ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îÇ    ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ
‚îÇ                                                              ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ
‚îÇ  ‚îÇ           CardOfDay Component                       ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ  - –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ 4 –∞—Ä–∫–∞–Ω–æ–≤                           ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ  - –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–µ–π —á–µ—Ä–µ–∑ API                       ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ  - Flip –∞–Ω–∏–º–∞—Ü–∏—è –∫–∞—Ä—Ç                              ‚îÇ    ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ
‚îÇ                                                              ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ
‚îÇ  ‚îÇ      lib/arcana/serialization.ts                    ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ  - serializeArcanaData()                            ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ  - parseArcanaData()                                ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ  - formatArcanaForDisplay()                         ‚îÇ    ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ
‚îÇ                                                              ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ
‚îÇ  ‚îÇ           localStorage                              ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ  - userName: string                                 ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ  - lastCalculationDate: string (ISO)                ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ  - arcanaData: string (JSON)                        ‚îÇ    ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                            ‚îÇ
                            ‚îÇ HTTP/HTTPS
                            ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    Next.js API Routes                        ‚îÇ
‚îÇ                                                              ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ
‚îÇ  ‚îÇ  PUT /api/user/profile                              ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ  - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Å—Å–∏–∏                                  ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ  - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª—è name –≤ User                      ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ  - –í–æ–∑–≤—Ä–∞—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö                       ‚îÇ    ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ
‚îÇ                                                              ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ
‚îÇ  ‚îÇ  GET /api/articles                                  ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ  - –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ relatedValue                       ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ  - –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ language                           ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ  - –í–æ–∑–≤—Ä–∞—Ç —Å—Ç–∞—Ç–µ–π –∞—Ä–∫–∞–Ω–æ–≤                           ‚îÇ    ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                            ‚îÇ
                            ‚îÇ Prisma ORM
                            ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ              PostgreSQL Database (Neon)                      ‚îÇ
‚îÇ                                                              ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ
‚îÇ  ‚îÇ  User Table                                         ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ  - id, email, name, passwordHash                    ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ  - preferredLang, isAdmin                           ‚îÇ    ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ
‚îÇ                                                              ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ
‚îÇ  ‚îÇ  Article Table                                      ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ  - id, title, content                               ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ  - category, language, relatedValue                 ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ  - 44 –∑–∞–ø–∏—Å–∏ –¥–ª—è –∞—Ä–∫–∞–Ω–æ–≤ (22 √ó 2 —è–∑—ã–∫–∞)            ‚îÇ    ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ
‚îÇ                                                              ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ
‚îÇ  ‚îÇ  Session Table                                      ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ  - id, userId, expiresAt                            ‚îÇ    ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö

#### 1. –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞—Ä–∫–∞–Ω–æ–≤ –≤ –ø–æ–ª–Ω–æ—á—å

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞
    ‚îÇ
    ‚îú‚îÄ> useEffect —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç setInterval (60 —Å–µ–∫—É–Ω–¥)
    ‚îÇ
    ‚îú‚îÄ> –ö–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É: –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—É—â–µ–π –¥–∞—Ç—ã
    ‚îÇ       ‚îÇ
    ‚îÇ       ‚îú‚îÄ> –ï—Å–ª–∏ –¥–∞—Ç–∞ –∏–∑–º–µ–Ω–∏–ª–∞—Å—å —Å lastCalculationDate
    ‚îÇ       ‚îÇ       ‚îÇ
    ‚îÇ       ‚îÇ       ‚îú‚îÄ> –ü–µ—Ä–µ—Å—á–µ—Ç –í–°–ï–• –∞—Ä–∫–∞–Ω–æ–≤ (–≤—Å–µ –∑–∞–≤–∏—Å—è—Ç –æ—Ç —Ç–µ–∫—É—â–µ–π –¥–∞—Ç—ã):
    ‚îÇ       ‚îÇ       ‚îÇ   - morning = (birthDateSum + currentDateSum) mod 22
    ‚îÇ       ‚îÇ       ‚îÇ   - day = (birthDateSum √ó currentDateSum) mod 22
    ‚îÇ       ‚îÇ       ‚îÇ   - evening = (nameSum + currentDateSum) mod 22
    ‚îÇ       ‚îÇ       ‚îÇ   - night = (morning + day + evening) mod 22
    ‚îÇ       ‚îÇ       ‚îÇ
    ‚îÇ       ‚îÇ       ‚îú‚îÄ> –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ state –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
    ‚îÇ       ‚îÇ       ‚îÇ
    ‚îÇ       ‚îÇ       ‚îî‚îÄ> –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–æ–≤–æ–π –¥–∞—Ç—ã –≤ localStorage
    ‚îÇ       ‚îÇ
    ‚îÇ       ‚îî‚îÄ> –ï—Å–ª–∏ –¥–∞—Ç–∞ –Ω–µ –∏–∑–º–µ–Ω–∏–ª–∞—Å—å: –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞—Ç—å
    ‚îÇ
    ‚îî‚îÄ> –ü—Ä–∏ —Ä–∞–∑–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏: clearInterval
```


#### 2. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –∑–∞–≥—Ä—É–∑–∫–∞ –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```
–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä
    ‚îÇ
    ‚îú‚îÄ> useEffect –ø—Ä–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏:
    ‚îÇ       ‚îÇ
    ‚îÇ       ‚îú‚îÄ> –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Å—Å–∏–∏ (GET /api/auth/session)
    ‚îÇ       ‚îÇ       ‚îÇ
    ‚îÇ       ‚îÇ       ‚îú‚îÄ> –ï—Å–ª–∏ —Å–µ—Å—Å–∏—è –≤–∞–ª–∏–¥–Ω–∞:
    ‚îÇ       ‚îÇ       ‚îÇ   - –ó–∞–≥—Ä—É–∑–∫–∞ user.name –∏–∑ –æ—Ç–≤–µ—Ç–∞
    ‚îÇ       ‚îÇ       ‚îÇ   - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤ state
    ‚îÇ       ‚îÇ       ‚îÇ   - –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å localStorage
    ‚îÇ       ‚îÇ       ‚îÇ
    ‚îÇ       ‚îÇ       ‚îî‚îÄ> –ï—Å–ª–∏ —Å–µ—Å—Å–∏—è –Ω–µ–≤–∞–ª–∏–¥–Ω–∞:
    ‚îÇ       ‚îÇ           - –ó–∞–≥—Ä—É–∑–∫–∞ –∏–º–µ–Ω–∏ –∏–∑ localStorage
    ‚îÇ       ‚îÇ
    ‚îÇ       ‚îî‚îÄ> –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏–º–µ–Ω–∏ –≤ input –ø–æ–ª–µ
    ‚îÇ
    ‚îî‚îÄ> –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ä–∞—Å—á–µ—Ç:
            ‚îÇ
            ‚îú‚îÄ> –ï—Å–ª–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω:
            ‚îÇ   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–º–µ–Ω–∏ –≤ localStorage
            ‚îÇ   - –û—Ç–ø—Ä–∞–≤–∫–∞ PUT /api/user/profile { name }
            ‚îÇ   - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª—è name –≤ —Ç–∞–±–ª–∏—Ü–µ User
            ‚îÇ
            ‚îî‚îÄ> –ï—Å–ª–∏ –Ω–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω:
                - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–º–µ–Ω–∏ —Ç–æ–ª—å–∫–æ –≤ localStorage
```

#### 3. –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–µ–π –∞—Ä–∫–∞–Ω–æ–≤

```
CardOfDay –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –º–æ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è —Å –¥–∞–Ω–Ω—ã–º–∏ –∞—Ä–∫–∞–Ω–æ–≤
    ‚îÇ
    ‚îú‚îÄ> useEffect –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Å—Ç–∞—Ç—å–∏:
    ‚îÇ       ‚îÇ
    ‚îÇ       ‚îú‚îÄ> –î–ª—è –∫–∞–∂–¥–æ–≥–æ —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ –∞—Ä–∫–∞–Ω–∞ (1-22):
    ‚îÇ       ‚îÇ   - GET /api/articles?relatedValue=arcana_{number}&language={locale}
    ‚îÇ       ‚îÇ   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ { title, content } –≤ state
    ‚îÇ       ‚îÇ
    ‚îÇ       ‚îî‚îÄ> –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫: –ø–æ–∫–∞–∑ "–ó–∞–≥—Ä—É–∑–∫–∞ –æ–ø–∏—Å–∞–Ω–∏—è..."
    ‚îÇ
    ‚îî‚îÄ> –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –∫–∞—Ä—Ç —Å –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–º–∏ —Å—Ç–∞—Ç—å—è–º–∏
```


## –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã

### 0. Arcana Calculator Algorithm (lib/arcana/arcanaCalculator.ts)

–ú–æ–¥—É–ª—å –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ 4 –∞—Ä–∫–∞–Ω–æ–≤ –¥–Ω—è —Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º.

**–ö–ª—é—á–µ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**

```typescript
/**
 * –í—ã—á–∏—Å–ª—è–µ—Ç —Å—É–º–º—É —Ü–∏—Ñ—Ä –¥–∞—Ç—ã —Å —É—á–µ—Ç–æ–º –º–∞—Å—Ç–µ—Ä-—á–∏—Å–µ–ª (11, 22)
 * @param date - –î–∞—Ç–∞ –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞
 * @returns –°—É–º–º–∞ —Ü–∏—Ñ—Ä (–º–æ–∂–µ—Ç –±—ã—Ç—å 11 –∏–ª–∏ 22 –∫–∞–∫ –º–∞—Å—Ç–µ—Ä-—á–∏—Å–ª–∞)
 */
function calculateDateSum(date: Date): number;

/**
 * –í—ã—á–∏—Å–ª—è–µ—Ç —Å—É–º–º—É –±—É–∫–≤ –∏–º–µ–Ω–∏ (–≤—Å–µ–≥–¥–∞ —Å–≤–æ–¥–∏—Ç—Å—è –∫ –æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ–º—É)
 * @param name - –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
 * @returns –û–¥–Ω–æ–∑–Ω–∞—á–Ω–æ–µ —á–∏—Å–ª–æ (1-9)
 */
function calculateNameSum(name: string): number;

/**
 * –ü—Ä–∏–≤–æ–¥–∏—Ç —á–∏—Å–ª–æ –∫ –¥–∏–∞–ø–∞–∑–æ–Ω—É 1-22 (–¥–ª—è –∞—Ä–∫–∞–Ω–æ–≤ –¢–∞—Ä–æ)
 * –ü—Ä–∞–≤–∏–ª–æ: –µ—Å–ª–∏ > 22, –≤—ã—á–∏—Ç–∞—Ç—å 22; –µ—Å–ª–∏ = 0, –≤–µ—Ä–Ω—É—Ç—å 22
 */
function reduceToArcana(num: number): number;

/**
 * –í—ã—á–∏—Å–ª—è–µ—Ç –≤—Å–µ 4 –∞—Ä–∫–∞–Ω–∞ –ø–æ –Ω–æ–≤–æ–º—É –∞–ª–≥–æ—Ä–∏—Ç–º—É
 * @param birthDate - –î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è
 * @param name - –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
 * @param currentDate - –¢–µ–∫—É—â–∞—è –¥–∞—Ç–∞
 * @returns –û–±—ä–µ–∫—Ç —Å 4 –∞—Ä–∫–∞–Ω–∞–º–∏
 */
function calculateDayCard(
  birthDate: Date,
  name: string,
  currentDate: Date = new Date()
): DayCardResult;
```

**–ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞—Å—á–µ—Ç–∞:**

1. **–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö:**
   - `birthDateSum` = —Å—É–º–º–∞ —Ü–∏—Ñ—Ä –¥–∞—Ç—ã —Ä–æ–∂–¥–µ–Ω–∏—è (—Å –º–∞—Å—Ç–µ—Ä-—á–∏—Å–ª–∞–º–∏ 11, 22)
   - `currentDateSum` = —Å—É–º–º–∞ —Ü–∏—Ñ—Ä —Ç–µ–∫—É—â–µ–π –¥–∞—Ç—ã (—Å –º–∞—Å—Ç–µ—Ä-—á–∏—Å–ª–∞–º–∏ 11, 22)
   - `nameSum` = —Å—É–º–º–∞ –±—É–∫–≤ –∏–º–µ–Ω–∏ (–≤—Å–µ–≥–¥–∞ –æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ–µ, 1-9)

2. **–†–∞—Å—á–µ—Ç –∞—Ä–∫–∞–Ω–æ–≤:**
   - `morning` = `reduceToArcana(birthDateSum + currentDateSum)`
   - `day` = `reduceToArcana(birthDateSum * currentDateSum)`
   - `evening` = `reduceToArcana(nameSum + currentDateSum)`
   - `night` = `reduceToArcana(morning + day + evening)`

**–í–∞–∂–Ω–æ:** –í—Å–µ 4 –∞—Ä–∫–∞–Ω–∞ –∑–∞–≤–∏—Å—è—Ç –æ—Ç —Ç–µ–∫—É—â–µ–π –¥–∞—Ç—ã –∏ –º–µ–Ω—è—é—Ç—Å—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ.

### 1. Midnight Check Hook (lib/hooks/useMidnightCheck.ts)

–ö–∞—Å—Ç–æ–º–Ω—ã–π React hook –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Å–º–µ–Ω—ã –¥–∞—Ç—ã.

```typescript
interface UseMidnightCheckOptions {
  onMidnight: () => void;
  enabled?: boolean;
  checkIntervalMs?: number; // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é 60000 (1 –º–∏–Ω—É—Ç–∞)
}

interface UseMidnightCheckReturn {
  lastCheckDate: Date | null;
  isChecking: boolean;
}

function useMidnightCheck(options: UseMidnightCheckOptions): UseMidnightCheckReturn
```

**–ü–æ–≤–µ–¥–µ–Ω–∏–µ:**
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç `setInterval` –¥–ª—è –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–∞—Ç—ã
- –°—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç —Ç–µ–∫—É—â—É—é –¥–∞—Ç—É —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω–æ–π –¥–∞—Ç–æ–π
- –ü—Ä–∏ —Å–º–µ–Ω–µ –¥–∞—Ç—ã –≤—ã–∑—ã–≤–∞–µ—Ç callback `onMidnight`
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—á–∏—â–∞–µ—Ç –∏–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–∏ —Ä–∞–∑–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏
- –ú–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç–∫–ª—é—á–µ–Ω —á–µ—Ä–µ–∑ `enabled: false`

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ Calculator.tsx:**

```typescript
const { lastCheckDate } = useMidnightCheck({
  onMidnight: () => {
    if (state.results?.arcana) {
      recalculateArcana(); // –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç –í–°–ï 4 –∞—Ä–∫–∞–Ω–∞
    }
  },
  enabled: !!state.results?.arcana,
});
```

### 2. User Profile API Endpoint (app/api/user/profile/route.ts)

–ù–æ–≤—ã–π API endpoint –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

```typescript
// PUT /api/user/profile
interface UpdateProfileRequest {
  name?: string;
  preferredLang?: string;
}

interface UpdateProfileResponse {
  success: boolean;
  user?: {
    id: string;
    email: string;
    name: string;
    preferredLang: string;
  };
  error?: string;
}
```

**–õ–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏:**

1. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ sessionId –∏–∑ cookies –∏–ª–∏ headers
2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ —Å–µ—Å—Å–∏–∏ —á–µ—Ä–µ–∑ `AuthService.verifySession()`
3. –ï—Å–ª–∏ —Å–µ—Å—Å–∏—è –Ω–µ–≤–∞–ª–∏–¥–Ω–∞ ‚Üí 401 Unauthorized
4. –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (name –Ω–µ –ø—É—Å—Ç–æ–µ, –¥–ª–∏–Ω–∞ < 100 —Å–∏–º–≤–æ–ª–æ–≤)
5. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏ User —á–µ—Ä–µ–∑ Prisma
6. –í–æ–∑–≤—Ä–∞—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è


### 3. Arcana Serialization Library (lib/arcana/serialization.ts)

–£—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏ –∞—Ä–∫–∞–Ω–æ–≤.

```typescript
import { DayCardResult } from './arcanaCalculator';

/**
 * –†–µ–∑—É–ª—å—Ç–∞—Ç –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–∞–Ω–Ω—ã—Ö –∞—Ä–∫–∞–Ω–æ–≤
 */
interface ParseResult<T> {
  success: boolean;
  data?: T;
  error?: string;
}

/**
 * –°–µ—Ä–∏–∞–ª–∏–∑—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –∞—Ä–∫–∞–Ω–æ–≤ –≤ JSON —Å—Ç—Ä–æ–∫—É
 * 
 * @param arcana - –û–±—ä–µ–∫—Ç —Å –¥–∞–Ω–Ω—ã–º–∏ –∞—Ä–∫–∞–Ω–æ–≤
 * @returns JSON —Å—Ç—Ä–æ–∫–∞
 */
export function serializeArcanaData(arcana: DayCardResult): string;

/**
 * –î–µ—Å–µ—Ä–∏–∞–ª–∏–∑—É–µ—Ç JSON —Å—Ç—Ä–æ–∫—É –≤ –æ–±—ä–µ–∫—Ç –∞—Ä–∫–∞–Ω–æ–≤
 * 
 * @param jsonString - JSON —Å—Ç—Ä–æ–∫–∞ —Å –¥–∞–Ω–Ω—ã–º–∏ –∞—Ä–∫–∞–Ω–æ–≤
 * @returns –†–µ–∑—É–ª—å—Ç–∞—Ç –ø–∞—Ä—Å–∏–Ω–≥–∞ —Å –¥–∞–Ω–Ω—ã–º–∏ –∏–ª–∏ –æ—à–∏–±–∫–æ–π
 */
export function parseArcanaData(jsonString: string): ParseResult<DayCardResult>;

/**
 * –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –∞—Ä–∫–∞–Ω–æ–≤ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
 * 
 * @param arcana - –û–±—ä–µ–∫—Ç —Å –¥–∞–Ω–Ω—ã–º–∏ –∞—Ä–∫–∞–Ω–æ–≤
 * @param locale - –Ø–∑—ã–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ ('ru' | 'en')
 * @returns –û–±—ä–µ–∫—Ç —Å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ —Å—Ç—Ä–æ–∫–∞–º–∏
 */
export function formatArcanaForDisplay(
  arcana: DayCardResult,
  locale: string
): {
  morning: string;
  day: string;
  evening: string;
  night: string;
};
```

**–î–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**

`serializeArcanaData`:
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `JSON.stringify()` —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π —Ç–∏–ø–æ–≤
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –∞—Ä–∫–∞–Ω–æ–≤ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ 1-22
- –î–æ–±–∞–≤–ª—è–µ—Ç –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (timestamp, version)

`parseArcanaData`:
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `JSON.parse()` —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫
- –í–∞–ª–∏–¥–∏—Ä—É–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –æ–±—ä–µ–∫—Ç–∞ (–Ω–∞–ª–∏—á–∏–µ –≤—Å–µ—Ö –ø–æ–ª–µ–π)
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç–∏–ø—ã (–≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è - —á–∏—Å–ª–∞)
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–∏–∞–ø–∞–∑–æ–Ω –∑–Ω–∞—á–µ–Ω–∏–π (1-22)
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `ParseResult` —Å `success: false` –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

`formatArcanaForDisplay`:
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ª–æ–∫–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è –ø–µ—Ä–∏–æ–¥–æ–≤ –¥–Ω—è
- –§–æ—Ä–º–∞—Ç: "–£—Ç—Ä–æ: –ê—Ä–∫–∞–Ω 15" –∏–ª–∏ "Morning: Arcana 15"


### 4. –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π Calculator Component

–ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ `Calculator.tsx`:

**–ù–æ–≤—ã–µ state –ø–æ–ª—è:**

```typescript
interface CalculatorState {
  // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è
  lastCalculationDate: string | null; // ISO –¥–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Ä–∞—Å—á–µ—Ç–∞
}
```

**–ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**

```typescript
// –ü–µ—Ä–µ—Å—á–µ—Ç –∞—Ä–∫–∞–Ω–æ–≤ –ø—Ä–∏ —Å–º–µ–Ω–µ –¥–∞—Ç—ã
const recalculateArcana = () => {
  if (!state.results?.arcana) return;
  
  // –ü–æ–ª—É—á–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ —Å—É–º–º—ã
  const birthDateSum = state.results.birthDateSum; // –ù—É–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –ø—Ä–∏ –ø–µ—Ä–≤–æ–º —Ä–∞—Å—á–µ—Ç–µ
  const nameSum = sumNameLetters(state.name);
  
  // –í—ã—á–∏—Å–ª—è–µ–º —Å—É–º–º—É —Ç–µ–∫—É—â–µ–π –¥–∞—Ç—ã
  const currentDate = new Date();
  const currentDateSum = calculateDateSum(currentDate); // –° —É—á–µ—Ç–æ–º –º–∞—Å—Ç–µ—Ä-—á–∏—Å–µ–ª
  
  // –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ–º –í–°–ï –∞—Ä–∫–∞–Ω—ã (–≤—Å–µ –∑–∞–≤–∏—Å—è—Ç –æ—Ç —Ç–µ–∫—É—â–µ–π –¥–∞—Ç—ã)
  const morning = reduceToArcana(birthDateSum + currentDateSum);
  const day = reduceToArcana(birthDateSum * currentDateSum);
  const evening = reduceToArcana(nameSum + currentDateSum);
  const night = reduceToArcana(morning + day + evening);
  
  setState(prev => ({
    ...prev,
    results: {
      ...prev.results,
      arcana: { morning, day, evening, night }
    },
    lastCalculationDate: new Date().toISOString(),
  }));
  
  // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ localStorage
  localStorage.setItem('lastCalculationDate', new Date().toISOString());
  localStorage.setItem('arcanaData', serializeArcanaData({ morning, day, evening, night }));
};

// –ó–∞–≥—Ä—É–∑–∫–∞ –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
const loadUserName = async () => {
  const sessionId = getSessionIdFromCookie();
  
  if (sessionId) {
    try {
      const response = await fetch(`/api/auth/session?sessionId=${sessionId}`);
      if (response.ok) {
        const { user } = await response.json();
        setState(prev => ({ ...prev, name: user.name }));
        localStorage.setItem('userName', user.name);
        return;
      }
    } catch (error) {
      console.error('Failed to load user name from session:', error);
    }
  }
  
  // Fallback –∫ localStorage
  const savedName = localStorage.getItem('userName');
  if (savedName) {
    setState(prev => ({ ...prev, name: savedName }));
  }
};

// –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
const saveUserName = async (name: string) => {
  localStorage.setItem('userName', name);
  
  const sessionId = getSessionIdFromCookie();
  if (sessionId) {
    try {
      await fetch('/api/user/profile', {
        method: 'PUT',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ name }),
      });
    } catch (error) {
      console.error('Failed to save user name to profile:', error);
    }
  }
};
```

**–ù–æ–≤—ã–µ useEffect hooks:**

```typescript
// –ó–∞–≥—Ä—É–∑–∫–∞ –∏–º–µ–Ω–∏ –ø—Ä–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏
useEffect(() => {
  loadUserName();
}, []);

// Midnight check
useMidnightCheck({
  onMidnight: recalculateArcana,
  enabled: !!state.results?.arcana,
});

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø–æ—Å–ª–µ –ø–æ–ª—É–Ω–æ—á–∏
useEffect(() => {
  const lastDate = localStorage.getItem('lastCalculationDate');
  if (lastDate && state.results?.arcana) {
    const lastCalculation = new Date(lastDate);
    const now = new Date();
    
    if (lastCalculation.toDateString() !== now.toDateString()) {
      recalculateArcana();
    }
  }
}, [state.results?.arcana]);
```


### 5. –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π CardOfDay Component

–ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ `CardOfDay.tsx`:

**–£–ª—É—á—à–µ–Ω–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞—Ç–µ–π:**

```typescript
// –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è: –∑–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–ª—å–∫–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∞—Ä–∫–∞–Ω–æ–≤
useEffect(() => {
  const loadArticles = async () => {
    const arcanaNumbers = [arcana.morning, arcana.day, arcana.evening, arcana.night];
    const uniqueArcanas = [...new Set(arcanaNumbers)];
    
    const loadedArticles: Record<number, ArcanaArticle> = {};
    
    // –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö —Å—Ç–∞—Ç–µ–π
    const promises = uniqueArcanas.map(async (num) => {
      try {
        const response = await fetch(
          `/api/articles?relatedValue=arcana_${num}&language=${locale}`
        );
        
        if (response.ok) {
          const data = await response.json();
          if (data.articles && data.articles.length > 0) {
            loadedArticles[num] = {
              title: data.articles[0].title,
              content: data.articles[0].content
            };
          }
        }
      } catch (error) {
        console.error(`Failed to load article for arcana ${num}:`, error);
      }
    });
    
    await Promise.all(promises);
    setArticles(loadedArticles);
  };

  loadArticles();
}, [arcana, locale]);
```

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö —Å—Ç–∞—Ç–µ–π:**

```typescript
const getArticleOrPlaceholder = (arcanaNumber: number): ArcanaArticle => {
  const article = articles[arcanaNumber];
  
  if (article) {
    return article;
  }
  
  return {
    title: locale === 'ru' ? '–ó–∞–≥—Ä—É–∑–∫–∞...' : 'Loading...',
    content: locale === 'ru' 
      ? '–ó–∞–≥—Ä—É–∑–∫–∞ –æ–ø–∏—Å–∞–Ω–∏—è –∞—Ä–∫–∞–Ω–∞...' 
      : 'Loading arcana description...'
  };
};
```


## –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö

### 1. DayCardResult (—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ç–∏–ø)

```typescript
interface DayCardResult {
  morning: number;   // –ê—Ä–∫–∞–Ω —É—Ç—Ä–∞ (1-22)
  day: number;       // –ê—Ä–∫–∞–Ω –¥–Ω—è (1-22)
  evening: number;   // –ê—Ä–∫–∞–Ω –≤–µ—á–µ—Ä–∞ (1-22)
  night: number;     // –ê—Ä–∫–∞–Ω –Ω–æ—á–∏ (1-22)
}
```

### 2. –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ User –º–æ–¥–µ–ª–∏ (Prisma)

–ü–æ–ª–µ `name` —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ —Å—Ö–µ–º–µ, –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è:

```prisma
model User {
  id              String        @id @default(cuid())
  email           String        @unique
  name            String        // –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  passwordHash    String
  preferredLang   String        @default("ru")
  // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–ª—è
}
```

### 3. Article –º–æ–¥–µ–ª—å –¥–ª—è –∞—Ä–∫–∞–Ω–æ–≤ (—Å—É—â–µ—Å—Ç–≤—É—é—â–∞—è)

```prisma
model Article {
  id              String        @id @default(cuid())
  title           String
  content         String        @db.Text
  category        String        // "Arcana (Cards)"
  language        String        @db.VarChar(2)  // "ru" –∏–ª–∏ "en"
  relatedValue    String?       // "arcana_1" –¥–æ "arcana_22"
  publishedAt     DateTime      @default(now())
  updatedAt       DateTime      @updatedAt
  
  @@index([category, language])
  @@index([relatedValue])
}
```

### 4. localStorage Schema

```typescript
interface LocalStorageSchema {
  // –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  userName: string;
  
  // –î–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Ä–∞—Å—á–µ—Ç–∞ (ISO 8601)
  lastCalculationDate: string;
  
  // –°–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∞—Ä–∫–∞–Ω–æ–≤ (JSON)
  arcanaData: string; // JSON.stringify(DayCardResult)
}
```

**–ü—Ä–∏–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö –≤ localStorage:**

```json
{
  "userName": "–ê–Ω–Ω–∞",
  "lastCalculationDate": "2024-01-15T23:45:00.000Z",
  "arcanaData": "{\"morning\":15,\"day\":8,\"evening\":12,\"night\":20}"
}
```


## API –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏

### PUT /api/user/profile

–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

**Request:**

```http
PUT /api/user/profile HTTP/1.1
Content-Type: application/json
Cookie: sessionId=abc123...

{
  "name": "–ê–Ω–Ω–∞"
}
```

**Response (Success):**

```http
HTTP/1.1 200 OK
Content-Type: application/json

{
  "success": true,
  "user": {
    "id": "clx123abc",
    "email": "anna@example.com",
    "name": "–ê–Ω–Ω–∞",
    "preferredLang": "ru"
  }
}
```

**Response (Unauthorized):**

```http
HTTP/1.1 401 Unauthorized
Content-Type: application/json

{
  "success": false,
  "error": "Invalid or expired session"
}
```

**Response (Validation Error):**

```http
HTTP/1.1 400 Bad Request
Content-Type: application/json

{
  "success": false,
  "error": "Name is required and must be less than 100 characters"
}
```

**–í–∞–ª–∏–¥–∞—Ü–∏—è:**
- `name`: –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ, —Å—Ç—Ä–æ–∫–∞, –¥–ª–∏–Ω–∞ 1-100 —Å–∏–º–≤–æ–ª–æ–≤
- –°–µ—Å—Å–∏—è –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤–∞–ª–∏–¥–Ω–æ–π (–ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ `AuthService.verifySession()`)


### GET /api/articles (—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π, –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)

–ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–µ–π –ø–æ —Å–≤—è–∑–∞–Ω–Ω–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—é.

**Request:**

```http
GET /api/articles?relatedValue=arcana_15&language=ru HTTP/1.1
```

**Response:**

```http
HTTP/1.1 200 OK
Content-Type: application/json

{
  "articles": [
    {
      "id": "clx456def",
      "title": "–î—å—è–≤–æ–ª",
      "content": "–ê—Ä–∫–∞–Ω XV —Å–∏–º–≤–æ–ª–∏–∑–∏—Ä—É–µ—Ç –∏—Å–∫—É—à–µ–Ω–∏–µ, –º–∞—Ç–µ—Ä–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∏–≤—è–∑–∞–Ω–Ω–æ—Å—Ç–∏...",
      "category": "Arcana (Cards)",
      "language": "ru",
      "relatedValue": "arcana_15",
      "publishedAt": "2024-01-01T00:00:00.000Z"
    }
  ]
}
```

**Query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `relatedValue`: —Å—Ç—Ä–æ–∫–∞, —Ñ–æ—Ä–º–∞—Ç "arcana_{number}" –≥–¥–µ number –æ—Ç 1 –¥–æ 22
- `language`: —Å—Ç—Ä–æ–∫–∞, "ru" –∏–ª–∏ "en" (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é "ru")


## Correctness Properties

*–°–≤–æ–π—Å—Ç–≤–æ (property) - —ç—Ç–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ –∏–ª–∏ –ø–æ–≤–µ–¥–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –¥–æ–ª–∂–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –¥–ª—è –≤—Å–µ—Ö –≤–∞–ª–∏–¥–Ω—ã—Ö –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–π —Å–∏—Å—Ç–µ–º—ã - –ø–æ —Å—É—Ç–∏, —Ñ–æ—Ä–º–∞–ª—å–Ω–æ–µ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ —Ç–æ–º, —á—Ç–æ —Å–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ –¥–µ–ª–∞—Ç—å. –°–≤–æ–π—Å—Ç–≤–∞ —Å–ª—É–∂–∞—Ç –º–æ—Å—Ç–æ–º –º–µ–∂–¥—É —á–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º—ã–º–∏ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è–º–∏ –∏ –º–∞—à–∏–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä—è–µ–º—ã–º–∏ –≥–∞—Ä–∞–Ω—Ç–∏—è–º–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏.*

### Property Reflection

–ü–æ—Å–ª–µ –∞–Ω–∞–ª–∏–∑–∞ acceptance criteria –±—ã–ª–∏ –≤—ã—è–≤–ª–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –≥—Ä—É–ø–ø—ã –∏–∑–±—ã—Ç–æ—á–Ω–æ—Å—Ç–∏:

**–ì—Ä—É–ø–ø–∞ 1: –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –∞—Ä–∫–∞–Ω–æ–≤ –≤ –ë–î (3.3, 3.4, 3.5)**
- –ö—Ä–∏—Ç–µ—Ä–∏–∏ 3.3, 3.4 –∏ 3.5 –ø—Ä–æ–≤–µ—Ä—è—é—Ç —Ä–∞–∑–Ω—ã–µ –ø–æ–ª—è –æ–¥–Ω–∏—Ö –∏ —Ç–µ—Ö –∂–µ –∑–∞–ø–∏—Å–µ–π
- –ú–æ–∂–Ω–æ –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å –≤ –æ–¥–Ω–æ –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Å–≤–æ–π—Å—Ç–≤–æ –æ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö –∞—Ä–∫–∞–Ω–æ–≤

**–ì—Ä—É–ø–ø–∞ 2: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∏–º–µ–Ω–∏ (2.8, 2.9)**
- –ö—Ä–∏—Ç–µ—Ä–∏–π 2.9 —è–≤–ª—è–µ—Ç—Å—è —á–∞—Å—Ç–Ω—ã–º —Å–ª—É—á–∞–µ–º 2.8
- –û–±–∞ –ø—Ä–æ–≤–µ—Ä—è—é—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –º–µ–∂–¥—É localStorage –∏ User_Profile
- –ú–æ–∂–Ω–æ –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å –≤ –æ–¥–Ω–æ —Å–≤–æ–π—Å—Ç–≤–æ –æ –¥–≤—É–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

**–ì—Ä—É–ø–ø–∞ 3: API –≤–∞–ª–∏–¥–∞—Ü–∏—è —Å–µ—Å—Å–∏–∏ (2.5, 2.6, 2.7)**
- –í—Å–µ —Ç—Ä–∏ –∫—Ä–∏—Ç–µ—Ä–∏—è –æ—Ç–Ω–æ—Å—è—Ç—Å—è –∫ –ø–æ–≤–µ–¥–µ–Ω–∏—é –æ–¥–Ω–æ–≥–æ endpoint
- –ú–æ–∂–Ω–æ –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å –≤ –æ–¥–Ω–æ —Å–≤–æ–π—Å—Ç–≤–æ –æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–µ –∑–∞–ø—Ä–æ—Å–æ–≤

**–ì—Ä—É–ø–ø–∞ 4: –ü–∞—Ä—Å–∏–Ω–≥ –¥–∞–Ω–Ω—ã—Ö (4.2, 4.3)**
- –ö—Ä–∏—Ç–µ—Ä–∏–π 4.3 —è–≤–ª—è–µ—Ç—Å—è —á–∞—Å—Ç—å—é 4.2
- Round-trip —Å–≤–æ–π—Å—Ç–≤–æ (4.6) —É–∂–µ –ø–æ–∫—Ä—ã–≤–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –ø–∞—Ä—Å–∏–Ω–≥–∞ –≤–∞–ª–∏–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

–ü–æ—Å–ª–µ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –∏–∑–±—ã—Ç–æ—á–Ω–æ—Å—Ç–∏ –æ—Å—Ç–∞—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞:


### Property 1: –í—Å–µ –∞—Ä–∫–∞–Ω—ã –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –ø—Ä–∏ —Å–º–µ–Ω–µ –¥–∞—Ç—ã

*–î–ª—è –ª—é–±–æ–π* –¥–∞—Ç—ã —Ä–æ–∂–¥–µ–Ω–∏—è, –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –¥–≤—É—Ö —Ä–∞–∑–Ω—ã—Ö —Ç–µ–∫—É—â–∏—Ö –¥–∞—Ç, –≤—Å–µ —á–µ—Ç—ã—Ä–µ –∞—Ä–∫–∞–Ω–∞ (–£—Ç—Ä–æ, –î–µ–Ω—å, –í–µ—á–µ—Ä, –ù–æ—á—å) –¥–æ–ª–∂–Ω—ã –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞—Ç—å—Å—è, —Ç–∞–∫ –∫–∞–∫ –≤—Å–µ –∑–∞–≤–∏—Å—è—Ç –æ—Ç —Ç–µ–∫—É—â–µ–π –¥–∞—Ç—ã.

**Validates: Requirements 1.2, 1.3, 1.7**

### Property 2: –ü–µ—Ä–µ—Å—á–µ—Ç –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø–æ—Å–ª–µ –ø–æ–ª—É–Ω–æ—á–∏

*–î–ª—è –ª—é–±–æ–π* —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–π –¥–∞—Ç—ã —Ä–∞—Å—á–µ—Ç–∞, –µ—Å–ª–∏ —Ç–µ–∫—É—â–∞—è –¥–∞—Ç–∞ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–π, —Ç–æ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞ —Å–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å –≤—Å–µ —á–µ—Ç—ã—Ä–µ –∞—Ä–∫–∞–Ω–∞ (–£—Ç—Ä–æ, –î–µ–Ω—å, –í–µ—á–µ—Ä, –ù–æ—á—å).

**Validates: Requirements 1.6**

### Property 3: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–º–µ–Ω–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

*–î–ª—è –ª—é–±–æ–≥–æ* –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –ª—é–±–æ–≥–æ –≤–∞–ª–∏–¥–Ω–æ–≥–æ –∏–º–µ–Ω–∏, –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ä–∞—Å—á–µ—Ç –∞—Ä–∫–∞–Ω–æ–≤, –∏–º—è –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ –≤ –ø–æ–ª–µ `name` —Ç–∞–±–ª–∏—Ü—ã User –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.

**Validates: Requirements 2.1**

### Property 4: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–º–µ–Ω–∏ –Ω–µ–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

*–î–ª—è –ª—é–±–æ–≥–æ* –Ω–µ–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –ª—é–±–æ–≥–æ –≤–∞–ª–∏–¥–Ω–æ–≥–æ –∏–º–µ–Ω–∏, –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ä–∞—Å—á–µ—Ç –∞—Ä–∫–∞–Ω–æ–≤, –∏–º—è –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ —Ç–æ–ª—å–∫–æ –≤ localStorage, –∏ –Ω–µ –¥–æ–ª–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å—Å—è –∑–∞–ø–∏—Å–µ–π –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.

**Validates: Requirements 2.2**

### Property 5: –ó–∞–≥—Ä—É–∑–∫–∞ –∏–º–µ–Ω–∏ –∏–∑ –ø—Ä–æ—Ñ–∏–ª—è

*–î–ª—è –ª—é–±–æ–≥–æ* –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–º –∏–º–µ–Ω–µ–º –≤ User_Profile, –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞ –∏–º—è –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –∑–∞–≥—Ä—É–∂–µ–Ω–æ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–æ –≤ –ø–æ–ª–µ –≤–≤–æ–¥–∞.

**Validates: Requirements 2.3**

### Property 6: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∏–º–µ–Ω–∏ –º–µ–∂–¥—É —Ö—Ä–∞–Ω–∏–ª–∏—â–∞–º–∏

*–î–ª—è –ª—é–±–æ–≥–æ* –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–æ–≥–¥–∞ –∏–º—è –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –≤ User_Profile –∏–ª–∏ –≤ localStorage, –æ–±–∞ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –¥–æ–ª–∂–Ω—ã —Å–æ–¥–µ—Ä–∂–∞—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–º–µ–Ω–∏.

**Validates: Requirements 2.8, 2.9**

### Property 7: API endpoint –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã

*–î–ª—è –ª—é–±–æ–≥–æ* –∑–∞–ø—Ä–æ—Å–∞ –∫ PUT /api/user/profile, —Å–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å —Å–µ—Å—Å–∏–∏ –∏ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å 401 –¥–ª—è –Ω–µ–≤–∞–ª–∏–¥–Ω—ã—Ö —Å–µ—Å—Å–∏–π, 400 –¥–ª—è –Ω–µ–≤–∞–ª–∏–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –∏–ª–∏ 200 —Å –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –¥–ª—è –≤–∞–ª–∏–¥–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤.

**Validates: Requirements 2.5, 2.6, 2.7**

### Property 8: –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –∞—Ä–∫–∞–Ω–æ–≤ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

*–î–ª—è –≤—Å–µ—Ö* –∑–∞–ø–∏—Å–µ–π —Å—Ç–∞—Ç–µ–π –∞—Ä–∫–∞–Ω–æ–≤ –≤ —Ç–∞–±–ª–∏—Ü–µ Article, –ø–æ–ª–µ `relatedValue` –¥–æ–ª–∂–Ω–æ –∏–º–µ—Ç—å —Ñ–æ—Ä–º–∞—Ç "arcana_{number}" (–≥–¥–µ number –æ—Ç 1 –¥–æ 22), –ø–æ–ª–µ `category` –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å "Arcana (Cards)", –∏ –ø–æ–ª–µ `language` –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å "ru" –∏–ª–∏ "en".

**Validates: Requirements 3.3, 3.4, 3.5**

### Property 9: –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å—Ç–∞—Ç–µ–π –ø–æ —è–∑—ã–∫—É

*–î–ª—è –ª—é–±–æ–≥–æ* –∑–∞–ø—Ä–æ—Å–∞ –∫ GET /api/articles —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º relatedValue=arcana_{number} –∏ language={locale}, —Å–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å —Å—Ç–∞—Ç—å—é –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω–æ–º —è–∑—ã–∫–µ, –µ—Å–ª–∏ –æ–Ω–∞ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.

**Validates: Requirements 3.7**

### Property 10: Round-trip —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∞—Ä–∫–∞–Ω–æ–≤

*–î–ª—è –ª—é–±–æ–≥–æ* –≤–∞–ª–∏–¥–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ DayCardResult, –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ parseArcanaData(serializeArcanaData(arcana)) –¥–æ–ª–∂–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –æ–±—ä–µ–∫—Ç, —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω—ã–π –∏—Å—Ö–æ–¥–Ω–æ–º—É.

**Validates: Requirements 4.6**

### Property 11: –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø–∞—Ä—Å–µ—Ä–æ–º

*–î–ª—è –ª—é–±–æ–π* –Ω–µ–≤–∞–ª–∏–¥–Ω–æ–π JSON —Å—Ç—Ä–æ–∫–∏ –∏–ª–∏ JSON —Å—Ç—Ä–æ–∫–∏ —Å –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π –¥–∞–Ω–Ω—ã—Ö –∞—Ä–∫–∞–Ω–æ–≤, —Ñ—É–Ω–∫—Ü–∏—è parseArcanaData –¥–æ–ª–∂–Ω–∞ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –æ–±—ä–µ–∫—Ç —Å `success: false` –∏ –æ–ø–∏—Å–∞—Ç–µ–ª—å–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º –æ–± –æ—à–∏–±–∫–µ.

**Validates: Requirements 4.4**


## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### 1. –û—à–∏–±–∫–∏ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∞—Ä–∫–∞–Ω–æ–≤

**–°—Ü–µ–Ω–∞—Ä–∏–π:** –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–µ—Ä–µ—Å—á–µ—Ç–µ –∞—Ä–∫–∞–Ω–æ–≤ –≤ –ø–æ–ª–Ω–æ—á—å

**–û–±—Ä–∞–±–æ—Ç–∫–∞:**
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–∫–∏ –≤ console.error
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∞—Ä–∫–∞–Ω–æ–≤ (–Ω–µ –æ–±–Ω–æ–≤–ª—è—Ç—å –ø—Ä–∏ –æ—à–∏–±–∫–µ)
- –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–π –ø—Ä–æ–≤–µ—Ä–∫–µ (—á–µ—Ä–µ–∑ 1 –º–∏–Ω—É—Ç—É)
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –≤—Ä—É—á–Ω—É—é –ø–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É "–†–∞—Å—Å—á–∏—Ç–∞—Ç—å"

**–ö–æ–¥:**

```typescript
try {
  recalculateArcana();
} catch (error) {
  console.error('Failed to recalculate arcana at midnight:', error);
  // –°–æ—Å—Ç–æ—è–Ω–∏–µ –æ—Å—Ç–∞–µ—Ç—Å—è –Ω–µ–∏–∑–º–µ–Ω–Ω—ã–º
}
```

### 2. –û—à–∏–±–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–°—Ü–µ–Ω–∞—Ä–∏–π 1:** –°–µ—Ç—å –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –≤ API

**–û–±—Ä–∞–±–æ—Ç–∫–∞:**
- –ò–º—è —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ localStorage (—É—Å–ø–µ—à–Ω–æ)
- –û—à–∏–±–∫–∞ API –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è, –Ω–æ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
- –ü—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º —Ä–∞—Å—á–µ—Ç–µ –±—É–¥–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

**–°—Ü–µ–Ω–∞—Ä–∏–π 2:** –°–µ—Å—Å–∏—è –∏—Å—Ç–µ–∫–ª–∞ –≤–æ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã

**–û–±—Ä–∞–±–æ—Ç–∫–∞:**
- API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 401 Unauthorized
- –ò–º—è –æ—Å—Ç–∞–µ—Ç—Å—è –≤ localStorage
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç—É –∫–∞–∫ –Ω–µ–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π
- –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –ø–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –≤—Ö–æ–¥–∞

**–ö–æ–¥:**

```typescript
try {
  const response = await fetch('/api/user/profile', {
    method: 'PUT',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ name }),
  });
  
  if (response.status === 401) {
    console.warn('Session expired, name saved locally only');
    // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –ø–æ–∫–∞–∑–∞—Ç—å toast —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
  } else if (!response.ok) {
    throw new Error(`HTTP ${response.status}`);
  }
} catch (error) {
  console.error('Failed to save name to profile:', error);
  // –ò–º—è —É–∂–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ –≤ localStorage, –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º —Ä–∞–±–æ—Ç—É
}
```

### 3. –û—à–∏–±–∫–∏ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞—Ç–µ–π –∞—Ä–∫–∞–Ω–æ–≤

**–°—Ü–µ–Ω–∞—Ä–∏–π 1:** –°—Ç–∞—Ç—å—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

**–û–±—Ä–∞–±–æ—Ç–∫–∞:**
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ placeholder —Ç–µ–∫—Å—Ç–∞: "–ó–∞–≥—Ä—É–∑–∫–∞ –æ–ø–∏—Å–∞–Ω–∏—è..." / "Loading description..."
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–µ–π —Å—Ç–∞—Ç—å–∏ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
- –ö–∞—Ä—Ç–∞ –æ—Å—Ç–∞–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–π (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–æ–º–µ—Ä –∞—Ä–∫–∞–Ω–∞)

**–°—Ü–µ–Ω–∞—Ä–∏–π 2:** –°–µ—Ç–µ–≤–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ

**–û–±—Ä–∞–±–æ—Ç–∫–∞:**
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–æ–≥–æ –∂–µ placeholder —Ç–µ–∫—Å—Ç–∞
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º —Ä–µ–Ω–¥–µ—Ä–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–∫–∏

**–ö–æ–¥:**

```typescript
try {
  const response = await fetch(`/api/articles?relatedValue=arcana_${num}&language=${locale}`);
  
  if (response.ok) {
    const data = await response.json();
    if (data.articles && data.articles.length > 0) {
      return data.articles[0];
    } else {
      console.warn(`No article found for arcana ${num}`);
    }
  }
} catch (error) {
  console.error(`Failed to load article for arcana ${num}:`, error);
}

// –í–æ–∑–≤—Ä–∞—Ç placeholder
return {
  title: locale === 'ru' ? '–ó–∞–≥—Ä—É–∑–∫–∞...' : 'Loading...',
  content: locale === 'ru' ? '–ó–∞–≥—Ä—É–∑–∫–∞ –æ–ø–∏—Å–∞–Ω–∏—è –∞—Ä–∫–∞–Ω–∞...' : 'Loading arcana description...'
};
```

### 4. –û—à–∏–±–∫–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–∞–Ω–Ω—ã—Ö –∞—Ä–∫–∞–Ω–æ–≤

**–°—Ü–µ–Ω–∞—Ä–∏–π 1:** –ù–µ–≤–∞–ª–∏–¥–Ω—ã–π JSON –≤ localStorage

**–û–±—Ä–∞–±–æ—Ç–∫–∞:**
- `parseArcanaData` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `{ success: false, error: "Invalid JSON" }`
- –î–∞–Ω–Ω—ã–µ –≤ localStorage –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–ø–æ–ª–Ω—è–µ—Ç –Ω–æ–≤—ã–π —Ä–∞—Å—á–µ—Ç
- –°—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏

**–°—Ü–µ–Ω–∞—Ä–∏–π 2:** JSON –≤–∞–ª–∏–¥–µ–Ω, –Ω–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞

**–û–±—Ä–∞–±–æ—Ç–∫–∞:**
- –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –≤—Å–µ—Ö –ø–æ–ª–µ–π (morning, day, evening, night)
- –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç–∏–ø—ã (–≤—Å–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —á–∏—Å–ª–∞–º–∏)
- –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–∏–∞–ø–∞–∑–æ–Ω (1-22)
- –ü—Ä–∏ –ª—é–±–æ–π –æ—à–∏–±–∫–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è `{ success: false, error: "–æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã" }`

**–ö–æ–¥:**

```typescript
export function parseArcanaData(jsonString: string): ParseResult<DayCardResult> {
  try {
    const data = JSON.parse(jsonString);
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
    if (!data || typeof data !== 'object') {
      return { success: false, error: 'Invalid data structure' };
    }
    
    const requiredFields = ['morning', 'day', 'evening', 'night'];
    for (const field of requiredFields) {
      if (!(field in data)) {
        return { success: false, error: `Missing field: ${field}` };
      }
      
      if (typeof data[field] !== 'number') {
        return { success: false, error: `Field ${field} must be a number` };
      }
      
      if (data[field] < 1 || data[field] > 22) {
        return { success: false, error: `Field ${field} must be between 1 and 22` };
      }
    }
    
    return { success: true, data };
  } catch (error) {
    return { 
      success: false, 
      error: error instanceof Error ? error.message : 'Unknown parsing error' 
    };
  }
}
```

### 5. –û—à–∏–±–∫–∏ API endpoint /api/user/profile

**–í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:**

```typescript
// –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –∏–º–µ–Ω–∏
if (!name || typeof name !== 'string') {
  return NextResponse.json(
    { success: false, error: 'Name is required and must be a string' },
    { status: 400 }
  );
}

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª–∏–Ω—ã
if (name.trim().length === 0 || name.length > 100) {
  return NextResponse.json(
    { success: false, error: 'Name must be between 1 and 100 characters' },
    { status: 400 }
  );
}
```

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:**

```typescript
try {
  const updatedUser = await prisma.user.update({
    where: { id: user.id },
    data: { name: name.trim() },
  });
  
  return NextResponse.json({ success: true, user: updatedUser });
} catch (error) {
  console.error('Database error updating user profile:', error);
  return NextResponse.json(
    { success: false, error: 'Failed to update profile' },
    { status: 500 }
  );
}
```


## –°—Ç—Ä–∞—Ç–µ–≥–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –ü–æ–¥—Ö–æ–¥ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **–¥–≤–æ–π–Ω–æ–π –ø–æ–¥—Ö–æ–¥ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é**:

1. **Unit-—Ç–µ—Å—Ç—ã**: –ø—Ä–æ–≤–µ—Ä—è—é—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã, –≥—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏ –∏ –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫
2. **Property-based —Ç–µ—Å—Ç—ã**: –ø—Ä–æ–≤–µ—Ä—è—é—Ç —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞ –Ω–∞ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

–û–±–∞ —Ç–∏–ø–∞ —Ç–µ—Å—Ç–æ–≤ –¥–æ–ø–æ–ª–Ω—è—é—Ç –¥—Ä—É–≥ –¥—Ä—É–≥–∞ –∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã –¥–ª—è –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–≥–æ –ø–æ–∫—Ä—ã—Ç–∏—è:
- Unit-—Ç–µ—Å—Ç—ã –ª–æ–≤—è—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –±–∞–≥–∏ –∏ –ø—Ä–æ–≤–µ—Ä—è—é—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–æ—á–∫–∏
- Property-based —Ç–µ—Å—Ç—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç –æ–±—â—É—é –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –Ω–∞ —à–∏—Ä–æ–∫–æ–º —Å–ø–µ–∫—Ç—Ä–µ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è property-based —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

**–í—ã–±–æ—Ä:** `fast-check` (—É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –≤ –ø—Ä–æ–µ–∫—Ç–µ)

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
- –ú–∏–Ω–∏–º—É–º 100 –∏—Ç–µ—Ä–∞—Ü–∏–π –Ω–∞ –∫–∞–∂–¥—ã–π property-—Ç–µ—Å—Ç
- –ö–∞–∂–¥—ã–π —Ç–µ—Å—Ç –ø–æ–º–µ—á–∞–µ—Ç—Å—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–º —Å —Å—Å—ã–ª–∫–æ–π –Ω–∞ —Å–≤–æ–π—Å—Ç–≤–æ –∏–∑ –¥–∏–∑–∞–π–Ω–∞
- –§–æ—Ä–º–∞—Ç —Ç–µ–≥–∞: `// Feature: arcana-enhancements, Property {number}: {–∫—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ}`

### –¢–µ—Å—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã

```
__tests__/
‚îú‚îÄ‚îÄ lib/
‚îÇ   ‚îú‚îÄ‚îÄ arcana/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ arcanaCalculator.test.ts (—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ serialization.test.ts (–Ω–æ–≤—ã–π)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ serialization.property.test.ts (–Ω–æ–≤—ã–π)
‚îÇ   ‚îî‚îÄ‚îÄ hooks/
‚îÇ       ‚îî‚îÄ‚îÄ useMidnightCheck.test.ts (–Ω–æ–≤—ã–π)
‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îî‚îÄ‚îÄ user/
‚îÇ       ‚îî‚îÄ‚îÄ profile.test.ts (–Ω–æ–≤—ã–π)
‚îî‚îÄ‚îÄ integration/
    ‚îú‚îÄ‚îÄ calculator-midnight-update.test.tsx (–Ω–æ–≤—ã–π)
    ‚îî‚îÄ‚îÄ calculator-name-sync.test.tsx (–Ω–æ–≤—ã–π)
```


### Property-Based —Ç–µ—Å—Ç—ã

#### 1. –¢–µ—Å—Ç Property 1: –í—Å–µ –∞—Ä–∫–∞–Ω—ã –º–µ–Ω—è—é—Ç—Å—è –ø—Ä–∏ —Å–º–µ–Ω–µ –¥–∞—Ç—ã

```typescript
// __tests__/lib/arcana/arcanaCalculator.property.test.ts
import * as fc from 'fast-check';
import { calculateDayCard } from '@/lib/arcana/arcanaCalculator';

describe('Arcana Calculator Properties', () => {
  // Feature: arcana-enhancements, Property 1: All arcana recalculate on date change
  it('should recalculate all arcana when date changes', () => {
    fc.assert(
      fc.property(
        fc.date(), // birthDate
        fc.integer({ min: 1, max: 100 }), // nameSum
        fc.date(), // date1
        fc.date(), // date2
        (birthDate, nameSum, date1, date2) => {
          const result1 = calculateDayCard(birthDate, nameSum, date1);
          const result2 = calculateDayCard(birthDate, nameSum, date2);
          
          // –ï—Å–ª–∏ –¥–∞—Ç—ã —Ä–∞–∑–Ω—ã–µ, –≤—Å–µ –∞—Ä–∫–∞–Ω—ã –º–æ–≥—É—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è
          // (—Ç–∞–∫ –∫–∞–∫ –≤—Å–µ –∑–∞–≤–∏—Å—è—Ç –æ—Ç —Ç–µ–∫—É—â–µ–π –¥–∞—Ç—ã)
          if (date1.toDateString() !== date2.toDateString()) {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –∞—Ä–∫–∞–Ω –∏–∑–º–µ–Ω–∏–ª—Å—è
            const hasChanged = 
              result1.morning !== result2.morning ||
              result1.day !== result2.day ||
              result1.evening !== result2.evening ||
              result1.night !== result2.night;
            
            // –î–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ —Å–ª—É—á–∞–µ–≤ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏–µ
            // (–Ω–æ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è –≤—Å–µ—Ö, —Ç–∞–∫ –∫–∞–∫ mod 22 –º–æ–∂–µ—Ç –¥–∞—Ç—å —Ç–æ—Ç –∂–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç)
          }
          
          // –ï—Å–ª–∏ –¥–∞—Ç—ã –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ, –≤—Å–µ –∞—Ä–∫–∞–Ω—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏
          if (date1.toDateString() === date2.toDateString()) {
            expect(result1).toEqual(result2);
          }
        }
      ),
      { numRuns: 100 }
    );
  });
});
```

#### 2. –¢–µ—Å—Ç Property 10: Round-trip —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏

```typescript
// __tests__/lib/arcana/serialization.property.test.ts
import * as fc from 'fast-check';
import { serializeArcanaData, parseArcanaData } from '@/lib/arcana/serialization';
import { DayCardResult } from '@/lib/arcana/arcanaCalculator';

describe('Arcana Serialization Properties', () => {
  // –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –≤–∞–ª–∏–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∞—Ä–∫–∞–Ω–æ–≤
  const arcanaArbitrary = fc.record({
    morning: fc.integer({ min: 1, max: 22 }),
    day: fc.integer({ min: 1, max: 22 }),
    evening: fc.integer({ min: 1, max: 22 }),
    night: fc.integer({ min: 1, max: 22 }),
  });

  // Feature: arcana-enhancements, Property 10: Round-trip serialization preserves data
  it('should preserve arcana data through serialize-parse round trip', () => {
    fc.assert(
      fc.property(arcanaArbitrary, (arcana) => {
        const serialized = serializeArcanaData(arcana);
        const parsed = parseArcanaData(serialized);
        
        expect(parsed.success).toBe(true);
        expect(parsed.data).toEqual(arcana);
      }),
      { numRuns: 100 }
    );
  });
});
```

#### 3. –¢–µ—Å—Ç Property 11: –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

```typescript
// Feature: arcana-enhancements, Property 11: Parser handles invalid data gracefully
it('should return error for invalid JSON strings', () => {
  fc.assert(
    fc.property(
      fc.oneof(
        fc.string(), // –°–ª—É—á–∞–π–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏
        fc.constant(''), // –ü—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞
        fc.constant('{invalid json}'), // –ù–µ–≤–∞–ª–∏–¥–Ω—ã–π JSON
        fc.record({ // –û–±—ä–µ–∫—Ç —Å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π
          morning: fc.integer({ min: -100, max: 100 }),
          day: fc.string(),
        }),
      ),
      (invalidData) => {
        const jsonString = typeof invalidData === 'string' 
          ? invalidData 
          : JSON.stringify(invalidData);
        
        const result = parseArcanaData(jsonString);
        
        // –î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –æ—à–∏–±–∫—É –¥–ª—è –Ω–µ–≤–∞–ª–∏–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
        if (result.success) {
          // –ï—Å–ª–∏ —É—Å–ø–µ—à–Ω–æ, –¥–∞–Ω–Ω—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤–∞–ª–∏–¥–Ω—ã–º–∏
          expect(result.data?.morning).toBeGreaterThanOrEqual(1);
          expect(result.data?.morning).toBeLessThanOrEqual(22);
          expect(result.data?.day).toBeGreaterThanOrEqual(1);
          expect(result.data?.day).toBeLessThanOrEqual(22);
          expect(result.data?.evening).toBeGreaterThanOrEqual(1);
          expect(result.data?.evening).toBeLessThanOrEqual(22);
          expect(result.data?.night).toBeGreaterThanOrEqual(1);
          expect(result.data?.night).toBeLessThanOrEqual(22);
        } else {
          expect(result.error).toBeDefined();
          expect(typeof result.error).toBe('string');
        }
      }
    ),
    { numRuns: 100 }
  );
});
```

#### 4. –¢–µ—Å—Ç Property 6: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∏–º–µ–Ω–∏

```typescript
// __tests__/integration/calculator-name-sync.property.test.tsx
import * as fc from 'fast-check';

// Feature: arcana-enhancements, Property 6: Name synchronization between storages
it('should keep name synchronized between localStorage and database', () => {
  fc.assert(
    fc.property(
      fc.string({ minLength: 1, maxLength: 100 }), // –í–∞–ª–∏–¥–Ω–æ–µ –∏–º—è
      async (name) => {
        // –°–∏–º—É–ª—è—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–º–µ–Ω–∏
        localStorage.setItem('userName', name);
        
        // –°–∏–º—É–ª—è—Ü–∏—è API –∑–∞–ø—Ä–æ—Å–∞
        const response = await fetch('/api/user/profile', {
          method: 'PUT',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ name }),
        });
        
        if (response.ok) {
          const localName = localStorage.getItem('userName');
          const { user } = await response.json();
          
          // –û–±–∞ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –¥–æ–ª–∂–Ω—ã —Å–æ–¥–µ—Ä–∂–∞—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤–æ–µ –∏–º—è
          expect(localName).toBe(name);
          expect(user.name).toBe(name);
        }
      }
    ),
    { numRuns: 100 }
  );
});
```


### Unit-—Ç–µ—Å—Ç—ã

#### 1. –¢–µ—Å—Ç—ã —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ (–∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã)

```typescript
// __tests__/lib/arcana/serialization.test.ts
import { serializeArcanaData, parseArcanaData, formatArcanaForDisplay } from '@/lib/arcana/serialization';

describe('Arcana Serialization', () => {
  describe('serializeArcanaData', () => {
    it('should serialize valid arcana data to JSON string', () => {
      const arcana = { morning: 15, day: 8, evening: 12, night: 20 };
      const result = serializeArcanaData(arcana);
      
      expect(typeof result).toBe('string');
      expect(JSON.parse(result)).toEqual(arcana);
    });
  });

  describe('parseArcanaData', () => {
    it('should parse valid JSON string to arcana object', () => {
      const jsonString = '{"morning":15,"day":8,"evening":12,"night":20}';
      const result = parseArcanaData(jsonString);
      
      expect(result.success).toBe(true);
      expect(result.data).toEqual({
        morning: 15,
        day: 8,
        evening: 12,
        night: 20,
      });
    });

    it('should return error for invalid JSON', () => {
      const result = parseArcanaData('invalid json');
      
      expect(result.success).toBe(false);
      expect(result.error).toBeDefined();
    });

    it('should return error for missing fields', () => {
      const jsonString = '{"morning":15,"day":8}';
      const result = parseArcanaData(jsonString);
      
      expect(result.success).toBe(false);
      expect(result.error).toContain('Missing field');
    });

    it('should return error for out of range values', () => {
      const jsonString = '{"morning":25,"day":8,"evening":12,"night":20}';
      const result = parseArcanaData(jsonString);
      
      expect(result.success).toBe(false);
      expect(result.error).toContain('between 1 and 22');
    });
  });

  describe('formatArcanaForDisplay', () => {
    it('should format arcana data for Russian locale', () => {
      const arcana = { morning: 15, day: 8, evening: 12, night: 20 };
      const result = formatArcanaForDisplay(arcana, 'ru');
      
      expect(result.morning).toBe('–£—Ç—Ä–æ: –ê—Ä–∫–∞–Ω 15');
      expect(result.day).toBe('–î–µ–Ω—å: –ê—Ä–∫–∞–Ω 8');
      expect(result.evening).toBe('–í–µ—á–µ—Ä: –ê—Ä–∫–∞–Ω 12');
      expect(result.night).toBe('–ù–æ—á—å: –ê—Ä–∫–∞–Ω 20');
    });

    it('should format arcana data for English locale', () => {
      const arcana = { morning: 15, day: 8, evening: 12, night: 20 };
      const result = formatArcanaForDisplay(arcana, 'en');
      
      expect(result.morning).toBe('Morning: Arcana 15');
      expect(result.day).toBe('Day: Arcana 8');
      expect(result.evening).toBe('Evening: Arcana 12');
      expect(result.night).toBe('Night: Arcana 20');
    });
  });
});
```

#### 2. –¢–µ—Å—Ç—ã API endpoint

```typescript
// __tests__/api/user/profile.test.ts
import { PUT } from '@/app/api/user/profile/route';
import { AuthService } from '@/lib/services/auth/AuthService';

jest.mock('@/lib/services/auth/AuthService');

describe('PUT /api/user/profile', () => {
  it('should update user name for authenticated user', async () => {
    const mockUser = { id: 'user123', email: 'test@example.com', name: 'Old Name' };
    (AuthService.prototype.verifySession as jest.Mock).mockResolvedValue(mockUser);

    const request = new Request('http://localhost/api/user/profile', {
      method: 'PUT',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ name: 'New Name' }),
    });

    const response = await PUT(request);
    const data = await response.json();

    expect(response.status).toBe(200);
    expect(data.success).toBe(true);
    expect(data.user.name).toBe('New Name');
  });

  it('should return 401 for invalid session', async () => {
    (AuthService.prototype.verifySession as jest.Mock).mockResolvedValue(null);

    const request = new Request('http://localhost/api/user/profile', {
      method: 'PUT',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ name: 'New Name' }),
    });

    const response = await PUT(request);
    const data = await response.json();

    expect(response.status).toBe(401);
    expect(data.success).toBe(false);
  });

  it('should return 400 for empty name', async () => {
    const mockUser = { id: 'user123', email: 'test@example.com', name: 'Old Name' };
    (AuthService.prototype.verifySession as jest.Mock).mockResolvedValue(mockUser);

    const request = new Request('http://localhost/api/user/profile', {
      method: 'PUT',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ name: '' }),
    });

    const response = await PUT(request);
    const data = await response.json();

    expect(response.status).toBe(400);
    expect(data.success).toBe(false);
  });

  it('should return 400 for name longer than 100 characters', async () => {
    const mockUser = { id: 'user123', email: 'test@example.com', name: 'Old Name' };
    (AuthService.prototype.verifySession as jest.Mock).mockResolvedValue(mockUser);

    const longName = 'a'.repeat(101);
    const request = new Request('http://localhost/api/user/profile', {
      method: 'PUT',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ name: longName }),
    });

    const response = await PUT(request);
    const data = await response.json();

    expect(response.status).toBe(400);
    expect(data.success).toBe(false);
  });
});
```


#### 3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

```typescript
// __tests__/integration/calculator-midnight-update.test.tsx
import { render, screen, waitFor, act } from '@testing-library/react';
import Calculator from '@/components/Calculator';
import { NextIntlClientProvider } from 'next-intl';

describe('Calculator Midnight Update', () => {
  beforeEach(() => {
    jest.useFakeTimers();
    localStorage.clear();
  });

  afterEach(() => {
    jest.useRealTimers();
  });

  it('should update arcana when date changes', async () => {
    const messages = {
      calculator: {
        title: '–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä',
        name: '–ò–º—è',
        calculate: '–†–∞—Å—Å—á–∏—Ç–∞—Ç—å',
        // ... –¥—Ä—É–≥–∏–µ –ø–µ—Ä–µ–≤–æ–¥—ã
      },
    };

    const { rerender } = render(
      <NextIntlClientProvider locale="ru" messages={messages}>
        <Calculator />
      </NextIntlClientProvider>
    );

    // –í—ã–ø–æ–ª–Ω—è–µ–º —Ä–∞—Å—á–µ—Ç
    // ... –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ñ–æ—Ä–º—ã –∏ –∫–ª–∏–∫ –Ω–∞ –∫–Ω–æ–ø–∫—É

    // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—É—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –í–°–ï–• –∞—Ä–∫–∞–Ω–æ–≤
    const initialMorning = screen.getByText(/–£—Ç—Ä–æ: –ê—Ä–∫–∞–Ω \d+/);
    const initialDay = screen.getByText(/–î–µ–Ω—å: –ê—Ä–∫–∞–Ω \d+/);
    const initialEvening = screen.getByText(/–í–µ—á–µ—Ä: –ê—Ä–∫–∞–Ω \d+/);
    const initialNight = screen.getByText(/–ù–æ—á—å: –ê—Ä–∫–∞–Ω \d+/);
    
    // –°–∏–º—É–ª–∏—Ä—É–µ–º —Å–º–µ–Ω—É –¥–∞—Ç—ã
    const tomorrow = new Date();
    tomorrow.setDate(tomorrow.getDate() + 1);
    jest.setSystemTime(tomorrow);

    // –ñ–¥–µ–º —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ (60 —Å–µ–∫—É–Ω–¥)
    act(() => {
      jest.advanceTimersByTime(60000);
    });

    await waitFor(() => {
      // –í–°–ï –∞—Ä–∫–∞–Ω—ã –¥–æ–ª–∂–Ω—ã –∏–∑–º–µ–Ω–∏—Ç—å—Å—è (—Å –≤—ã—Å–æ–∫–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é)
      // —Ç–∞–∫ –∫–∞–∫ –≤—Å–µ –∑–∞–≤–∏—Å—è—Ç –æ—Ç —Ç–µ–∫—É—â–µ–π –¥–∞—Ç—ã
      const newMorning = screen.getByText(/–£—Ç—Ä–æ: –ê—Ä–∫–∞–Ω \d+/);
      const newDay = screen.getByText(/–î–µ–Ω—å: –ê—Ä–∫–∞–Ω \d+/);
      const newEvening = screen.getByText(/–í–µ—á–µ—Ä: –ê—Ä–∫–∞–Ω \d+/);
      const newNight = screen.getByText(/–ù–æ—á—å: –ê—Ä–∫–∞–Ω \d+/);
    });
  });

  it('should recalculate on page load after midnight', async () => {
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞—Ç—É –≤—á–µ—Ä–∞—à–Ω–µ–≥–æ —Ä–∞—Å—á–µ—Ç–∞
    const yesterday = new Date();
    yesterday.setDate(yesterday.getDate() - 1);
    localStorage.setItem('lastCalculationDate', yesterday.toISOString());
    localStorage.setItem('arcanaData', JSON.stringify({
      morning: 15,
      day: 8,
      evening: 12,
      night: 20,
    }));

    const messages = { /* ... */ };

    render(
      <NextIntlClientProvider locale="ru" messages={messages}>
        <Calculator />
      </NextIntlClientProvider>
    );

    // –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å –∞—Ä–∫–∞–Ω—ã
    await waitFor(() => {
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –¥–∞—Ç–∞ –æ–±–Ω–æ–≤–∏–ª–∞—Å—å
      const currentDate = localStorage.getItem('lastCalculationDate');
      expect(new Date(currentDate!).toDateString()).toBe(new Date().toDateString());
    });
  });
});
```

#### 4. –¢–µ—Å—Ç—ã –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞—Ç–µ–π

```typescript
// __tests__/integration/card-of-day-articles.test.tsx
import { render, screen, waitFor } from '@testing-library/react';
import CardOfDay from '@/components/CardOfDay';
import { NextIntlClientProvider } from 'next-intl';

global.fetch = jest.fn();

describe('CardOfDay Articles Loading', () => {
  beforeEach(() => {
    (fetch as jest.Mock).mockClear();
  });

  it('should load and display arcana articles', async () => {
    const mockArticle = {
      id: '1',
      title: '–î—å—è–≤–æ–ª',
      content: '–û–ø–∏—Å–∞–Ω–∏–µ –∞—Ä–∫–∞–Ω–∞ –î—å—è–≤–æ–ª...',
      category: 'Arcana (Cards)',
      language: 'ru',
      relatedValue: 'arcana_15',
    };

    (fetch as jest.Mock).mockResolvedValue({
      ok: true,
      json: async () => ({ articles: [mockArticle] }),
    });

    const arcana = { morning: 15, day: 8, evening: 12, night: 20 };
    const messages = { calculator: { cardOfDay: '–ö–∞—Ä—Ç–∞ –¥–Ω—è' } };

    render(
      <NextIntlClientProvider locale="ru" messages={messages}>
        <CardOfDay arcana={arcana} />
      </NextIntlClientProvider>
    );

    await waitFor(() => {
      expect(fetch).toHaveBeenCalledWith(
        expect.stringContaining('relatedValue=arcana_15')
      );
    });
  });

  it('should display placeholder when article not found', async () => {
    (fetch as jest.Mock).mockResolvedValue({
      ok: true,
      json: async () => ({ articles: [] }),
    });

    const arcana = { morning: 15, day: 8, evening: 12, night: 20 };
    const messages = { calculator: { cardOfDay: '–ö–∞—Ä—Ç–∞ –¥–Ω—è' } };

    render(
      <NextIntlClientProvider locale="ru" messages={messages}>
        <CardOfDay arcana={arcana} />
      </NextIntlClientProvider>
    );

    await waitFor(() => {
      expect(screen.getByText(/–ó–∞–≥—Ä—É–∑–∫–∞ –æ–ø–∏—Å–∞–Ω–∏—è/i)).toBeInTheDocument();
    });
  });
});
```

### –ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏

**–¶–µ–ª–µ–≤–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ:**
- –§—É–Ω–∫—Ü–∏–∏ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏: 100% (–∫—Ä–∏—Ç–∏—á–Ω—ã–µ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö)
- API endpoints: 90%+ (–≤—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∏ –æ—à–∏–±–∫–∏)
- React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã: 80%+ (–æ—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏)
- –£—Ç–∏–ª–∏—Ç—ã –∏ —Ö—É–∫–∏: 90%+

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã:**
1. Property-based —Ç–µ—Å—Ç—ã –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Å–≤–æ–π—Å—Ç–≤ (round-trip, –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã)
2. Unit-—Ç–µ—Å—Ç—ã –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫
3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
4. Edge cases (–ø—É—Å—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ, –≥—Ä–∞–Ω–∏—á–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è)


## –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –§–∞–∑–∞ 1: –ü–∞—Ä—Å–µ—Ä –∏ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö (–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ 4)

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –í—ã—Å–æ–∫–∏–π (–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –¥–ª—è –¥—Ä—É–≥–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤)

**–ó–∞–¥–∞—á–∏:**
1. –°–æ–∑–¥–∞—Ç—å `lib/arcana/serialization.ts`
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `serializeArcanaData()`
3. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `parseArcanaData()` —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
4. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `formatArcanaForDisplay()`
5. –ù–∞–ø–∏—Å–∞—Ç—å unit-—Ç–µ—Å—Ç—ã
6. –ù–∞–ø–∏—Å–∞—Ç—å property-based —Ç–µ—Å—Ç—ã (round-trip)

**–û—Ü–µ–Ω–∫–∞:** 4-6 —á–∞—Å–æ–≤

### –§–∞–∑–∞ 2: API endpoint –¥–ª—è –ø—Ä–æ—Ñ–∏–ª—è (–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ 2, —á–∞—Å—Ç—å 1)

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –í—ã—Å–æ–∫–∏–π

**–ó–∞–¥–∞—á–∏:**
1. –°–æ–∑–¥–∞—Ç—å `app/api/user/profile/route.ts`
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å PUT handler —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π —Å–µ—Å—Å–∏–∏
3. –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
4. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ User —á–µ—Ä–µ–∑ Prisma
5. –ù–∞–ø–∏—Å–∞—Ç—å unit-—Ç–µ—Å—Ç—ã –¥–ª—è API
6. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å Postman/curl

**–û—Ü–µ–Ω–∫–∞:** 3-4 —á–∞—Å–∞

### –§–∞–∑–∞ 3: –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–µ–π –∞—Ä–∫–∞–Ω–æ–≤ (–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ 3)

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –°—Ä–µ–¥–Ω–∏–π

**–ó–∞–¥–∞—á–∏:**
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å SQL —Å–∫—Ä–∏–ø—Ç `prisma/seed-arcana-articles.sql`
2. –í—ã–ø–æ–ª–Ω–∏—Ç—å —Å–∫—Ä–∏–ø—Ç –≤ Neon SQL Editor
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ 44 –∑–∞–ø–∏—Å–µ–π –≤ —Ç–∞–±–ª–∏—Ü–µ Article
4. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å GET /api/articles —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ arcana
5. –û–±–Ω–æ–≤–∏—Ç—å CardOfDay –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö —Å—Ç–∞—Ç–µ–π

**–û—Ü–µ–Ω–∫–∞:** 2-3 —á–∞—Å–∞

### –§–∞–∑–∞ 4: Midnight Check Hook (–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ 1, —á–∞—Å—Ç—å 1)

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –í—ã—Å–æ–∫–∏–π

**–ó–∞–¥–∞—á–∏:**
1. –°–æ–∑–¥–∞—Ç—å `lib/hooks/useMidnightCheck.ts`
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ª–æ–≥–∏–∫—É –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–º–µ–Ω—ã –¥–∞—Ç—ã
3. –î–æ–±–∞–≤–∏—Ç—å cleanup –ø—Ä–∏ —Ä–∞–∑–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏
4. –ù–∞–ø–∏—Å–∞—Ç—å unit-—Ç–µ—Å—Ç—ã —Å jest.useFakeTimers()
5. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å —Ä–∞–∑–Ω—ã–º–∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞–º–∏

**–û—Ü–µ–Ω–∫–∞:** 3-4 —á–∞—Å–∞

### –§–∞–∑–∞ 5: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ Calculator (–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è 1 –∏ 2)

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –í—ã—Å–æ–∫–∏–π

**–ó–∞–¥–∞—á–∏:**
1. –î–æ–±–∞–≤–∏—Ç—å `lastCalculationDate` –≤ state
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `recalculateArcana()`
3. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `loadUserName()`
4. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `saveUserName()`
5. –î–æ–±–∞–≤–∏—Ç—å useEffect –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏–º–µ–Ω–∏
6. –î–æ–±–∞–≤–∏—Ç—å useMidnightCheck hook
7. –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –ø—Ä–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏
8. –û–±–Ω–æ–≤–∏—Ç—å handleCalculate –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞—Ç—ã
9. –ù–∞–ø–∏—Å–∞—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã

**–û—Ü–µ–Ω–∫–∞:** 6-8 —á–∞—Å–æ–≤

### –§–∞–∑–∞ 6: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Ç–ª–∞–¥–∫–∞

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π

**–ó–∞–¥–∞—á–∏:**
1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ unit-—Ç–µ—Å—Ç—ã
2. –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ property-based —Ç–µ—Å—Ç—ã
3. –ó–∞–ø—É—Å—Ç–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
4. –†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
5. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —á–∞—Å–æ–≤—ã—Ö –ø–æ—è—Å–∞—Ö
6. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏/–Ω–µ–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
7. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ localStorage –∏ –ë–î
8. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –±–∞–≥–æ–≤

**–û—Ü–µ–Ω–∫–∞:** 4-6 —á–∞—Å–æ–≤

### –û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏

**–ú–∏–Ω–∏–º—É–º:** 22 —á–∞—Å–∞  
**–ú–∞–∫—Å–∏–º—É–º:** 31 —á–∞—Å  
**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –±—É—Ñ–µ—Ä:** +20% = 26-37 —á–∞—Å–æ–≤


## –†–∏—Å–∫–∏ –∏ –º–∏—Ç–∏–≥–∞—Ü–∏—è

### –†–∏—Å–∫ 1: –ü—Ä–æ–±–ª–µ–º—ã —Å —á–∞—Å–æ–≤—ã–º–∏ –ø–æ—è—Å–∞–º–∏

**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤ —Ä–∞–∑–Ω—ã—Ö —á–∞—Å–æ–≤—ã—Ö –ø–æ—è—Å–∞—Ö –º–æ–≥—É—Ç –ø–æ–ª—É—á–∞—Ç—å –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∞—Ä–∫–∞–Ω–æ–≤.

**–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å:** –°—Ä–µ–¥–Ω—è—è  
**–í–ª–∏—è–Ω–∏–µ:** –í—ã—Å–æ–∫–æ–µ

**–ú–∏—Ç–∏–≥–∞—Ü–∏—è:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `Date.toDateString()` –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –¥–∞—Ç (–∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç –≤—Ä–µ–º—è)
- –•—Ä–∞–Ω–∏—Ç—å –¥–∞—Ç—ã –≤ ISO —Ñ–æ—Ä–º–∞—Ç–µ (UTC)
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å —Ä–∞–∑–Ω—ã–º–∏ —á–∞—Å–æ–≤—ã–º–∏ –ø–æ—è—Å–∞–º–∏
- –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### –†–∏—Å–∫ 2: –ü–æ—Ç–µ—Ä—è –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –æ—à–∏–±–∫–µ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏

**–û–ø–∏—Å–∞–Ω–∏–µ:** –ù–µ–≤–∞–ª–∏–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ localStorage –º–æ–≥—É—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –ø–æ—Ç–µ—Ä–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –∞—Ä–∫–∞–Ω–æ–≤.

**–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å:** –ù–∏–∑–∫–∞—è  
**–í–ª–∏—è–Ω–∏–µ:** –°—Ä–µ–¥–Ω–µ–µ

**–ú–∏—Ç–∏–≥–∞—Ü–∏—è:**
- –°—Ç—Ä–æ–≥–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤ `parseArcanaData()`
- Graceful fallback –∫ –ø–µ—Ä–µ—Å—á–µ—Ç—É –ø—Ä–∏ –æ—à–∏–±–∫–µ
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- Property-based —Ç–µ—Å—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏

### –†–∏—Å–∫ 3: –†–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è localStorage –∏ –ë–î

**–û–ø–∏—Å–∞–Ω–∏–µ:** –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –º–æ–∂–µ—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è –≤ localStorage –∏ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.

**–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å:** –°—Ä–µ–¥–Ω—è—è  
**–í–ª–∏—è–Ω–∏–µ:** –ù–∏–∑–∫–æ–µ

**–ú–∏—Ç–∏–≥–∞—Ü–∏—è:**
- –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –ë–î –Ω–∞–¥ localStorage –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Ä–∞—Å—á–µ—Ç–µ
- –Ø–≤–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å–µ—Ç–∏
- –¢–µ—Å—Ç—ã —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

### –†–∏—Å–∫ 4: –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏ —á–∞—Å—Ç—ã—Ö –ø—Ä–æ–≤–µ—Ä–∫–∞—Ö

**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É –º–æ–∂–µ—Ç –≤–ª–∏—è—Ç—å –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å.

**–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å:** –ù–∏–∑–∫–∞—è  
**–í–ª–∏—è–Ω–∏–µ:** –ù–∏–∑–∫–æ–µ

**–ú–∏—Ç–∏–≥–∞—Ü–∏—è:**
- –õ–µ–≥–∫–æ–≤–µ—Å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (—Ç–æ–ª—å–∫–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–∞—Ç)
- –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ–≥–¥–∞ –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ä–∞—Å—á–µ—Ç–æ–≤
- Cleanup –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ –ø—Ä–∏ —Ä–∞–∑–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤ production

### –†–∏—Å–∫ 5: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å—Ç–∞—Ç–µ–π –≤ –ë–î

**–û–ø–∏—Å–∞–Ω–∏–µ:** SQL —Å–∫—Ä–∏–ø—Ç –º–æ–∂–µ—Ç –±—ã—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏–ª–∏ —Å—Ç–∞—Ç—å–∏ –º–æ–≥—É—Ç –±—ã—Ç—å —É–¥–∞–ª–µ–Ω—ã.

**–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å:** –ù–∏–∑–∫–∞—è  
**–í–ª–∏—è–Ω–∏–µ:** –°—Ä–µ–¥–Ω–µ–µ

**–ú–∏—Ç–∏–≥–∞—Ü–∏—è:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è 44 –∑–∞–ø–∏—Å–µ–π –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–∞
- Graceful fallback –∫ placeholder —Ç–µ–∫—Å—Ç—É
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö —Å—Ç–∞—Ç–µ–π
- –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç–µ–π

### –†–∏—Å–∫ 6: –ò—Å—Ç–µ—á–µ–Ω–∏–µ —Å–µ—Å—Å–∏–∏ –≤–æ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã

**–û–ø–∏—Å–∞–Ω–∏–µ:** –°–µ—Å—Å–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –º–æ–∂–µ—Ç –∏—Å—Ç–µ—á—å, –ø–æ–∫–∞ –æ–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–æ–º.

**–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å:** –°—Ä–µ–¥–Ω—è—è  
**–í–ª–∏—è–Ω–∏–µ:** –ù–∏–∑–∫–æ–µ

**–ú–∏—Ç–∏–≥–∞—Ü–∏—è:**
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ localStorage –∫–∞–∫ fallback
- –û–±—Ä–∞–±–æ—Ç–∫–∞ 401 –æ—à–∏–±–æ–∫ –±–µ–∑ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è —Ä–∞–±–æ—Ç—ã
- –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ —Ä–µ–∂–∏–º –±–µ–∑ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏


## –°–æ–æ–±—Ä–∞–∂–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### 1. –í–∞–ª–∏–¥–∞—Ü–∏—è —Å–µ—Å—Å–∏–∏

**–£–≥—Ä–æ–∑–∞:** –ù–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—é –ø—Ä–æ—Ñ–∏–ª—è

**–ó–∞—â–∏—Ç–∞:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ —Å–µ—Å—Å–∏–∏ —á–µ—Ä–µ–∑ `AuthService.verifySession()`
- –í–æ–∑–≤—Ä–∞—Ç 401 –¥–ª—è –Ω–µ–≤–∞–ª–∏–¥–Ω—ã—Ö —Å–µ—Å—Å–∏–π
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –¥–∞–Ω–Ω—ã—Ö —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–∏–∑ —Å–µ—Å—Å–∏–∏)
- –ó–∞–ø—Ä–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —á—É–∂–∏—Ö –ø—Ä–æ—Ñ–∏–ª–µ–π

**–ö–æ–¥:**

```typescript
const user = await authService.verifySession(sessionId);
if (!user) {
  return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });
}

// –û–±–Ω–æ–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –ø—Ä–æ—Ñ–∏–ª—å —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
await prisma.user.update({
  where: { id: user.id }, // ID –∏–∑ —Å–µ—Å—Å–∏–∏, –Ω–µ –∏–∑ –∑–∞–ø—Ä–æ—Å–∞
  data: { name },
});
```

### 2. –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**–£–≥—Ä–æ–∑–∞:** XSS –∞—Ç–∞–∫–∏ —á–µ—Ä–µ–∑ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–ó–∞—â–∏—Ç–∞:**
- –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª–∏–Ω—ã –∏–º–µ–Ω–∏ (1-100 —Å–∏–º–≤–æ–ª–æ–≤)
- Trim –ø—Ä–æ–±–µ–ª–æ–≤
- –°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ –∏ —Å–µ—Ä–≤–µ—Ä–µ
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ React (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π escaping)

**–ö–æ–¥:**

```typescript
if (!name || name.trim().length === 0 || name.length > 100) {
  return NextResponse.json({ error: 'Invalid name' }, { status: 400 });
}

const sanitizedName = name.trim();
```

### 3. Rate Limiting

**–£–≥—Ä–æ–∑–∞:** DoS –∞—Ç–∞–∫–∏ –Ω–∞ API endpoint

**–ó–∞—â–∏—Ç–∞:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ middleware –¥–ª—è rate limiting
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

### 4. SQL Injection

**–£–≥—Ä–æ–∑–∞:** SQL –∏–Ω—ä–µ–∫—Ü–∏–∏ —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

**–ó–∞—â–∏—Ç–∞:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Prisma ORM (–ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã)
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä—è–º—ã—Ö SQL –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –∫–æ–¥–µ
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### 5. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å localStorage

**–£–≥—Ä–æ–∑–∞:** XSS –∞—Ç–∞–∫–∏ –¥–ª—è –∫—Ä–∞–∂–∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑ localStorage

**–ó–∞—â–∏—Ç–∞:**
- –•—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –Ω–µ—Å–µ–Ω—Å–∏—Ç–∏–≤–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–∏–º—è, –¥–∞—Ç–∞, –∞—Ä–∫–∞–Ω—ã)
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ –∏–ª–∏ –ø–∞—Ä–æ–ª–µ–π –≤ localStorage
- Content Security Policy (CSP) –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç XSS
- –†–µ–≥—É–ª—è—Ä–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### 6. HTTPS

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ:** –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∫ API –¥–æ–ª–∂–Ω—ã –∏–¥—Ç–∏ —á–µ—Ä–µ–∑ HTTPS

**–ó–∞—â–∏—Ç–∞:**
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Next.js –¥–ª—è HTTPS –≤ production
- Redirect —Å HTTP –Ω–∞ HTTPS
- Secure cookies –¥–ª—è —Å–µ—Å—Å–∏–π


## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### 1. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞—Ç–µ–π

**–ü—Ä–æ–±–ª–µ–º–∞:** –ó–∞–≥—Ä—É–∑–∫–∞ 4 —Å—Ç–∞—Ç–µ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω–æ–π

**–†–µ—à–µ–Ω–∏–µ:**
- –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ `Promise.all()`
- –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–ª—å–∫–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∞—Ä–∫–∞–Ω–æ–≤ (–º–æ–∂–µ—Ç –±—ã—Ç—å 1-4 –∑–∞–ø—Ä–æ—Å–∞ –≤–º–µ—Å—Ç–æ 4)
- –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç–µ–π –≤ state –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞

**–ö–æ–¥:**

```typescript
const uniqueArcanas = [...new Set([arcana.morning, arcana.day, arcana.evening, arcana.night])];
const promises = uniqueArcanas.map(num => fetchArticle(num));
await Promise.all(promises);
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –°–æ–∫—Ä–∞—â–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–≥—Ä—É–∑–∫–∏ —Å ~400ms –¥–æ ~100ms (–ø—Ä–∏ 4 —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∞—Ä–∫–∞–Ω–∞—Ö)

### 2. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è midnight check

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É –º–æ–∂–µ—Ç –±—ã—Ç—å –∏–∑–±—ã—Ç–æ—á–Ω–æ–π

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ –µ—Å—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–µ —Ä–∞—Å—á–µ—Ç—ã (`enabled` —Ñ–ª–∞–≥)
- –õ–µ–≥–∫–æ–≤–µ—Å–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–∞—Ç (—Ç–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫–∏)
- Cleanup –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ –ø—Ä–∏ —Ä–∞–∑–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏

**–ö–æ–¥:**

```typescript
useMidnightCheck({
  onMidnight: recalculateArcana,
  enabled: !!state.results?.arcana, // –¢–æ–ª—å–∫–æ –µ—Å–ª–∏ –µ—Å—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
});
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (~0.1ms –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É)

### 3. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏

**–ü—Ä–æ–±–ª–µ–º–∞:** JSON.stringify –º–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω—ã–º –¥–ª—è –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–∫—Ç–æ–≤

**–†–µ—à–µ–Ω–∏–µ:**
- –û–±—ä–µ–∫—Ç –∞—Ä–∫–∞–Ω–æ–≤ –æ—á–µ–Ω—å –º–∞–ª–µ–Ω—å–∫–∏–π (4 —á–∏—Å–ª–∞)
- –ù–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø–∞—Ä—Å–∏–Ω–≥–µ

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ~0.01ms –Ω–∞ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—é, ~0.05ms –Ω–∞ –ø–∞—Ä—Å–∏–Ω–≥

### 4. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è API –∑–∞–ø—Ä–æ—Å–æ–≤

**–ü—Ä–æ–±–ª–µ–º–∞:** –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ /api/user/profile

**–†–µ—à–µ–Ω–∏–µ:**
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ localStorage –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ
- API –∑–∞–ø—Ä–æ—Å –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –±–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ UI
- –û—à–∏–±–∫–∏ API –Ω–µ –≤–ª–∏—è—é—Ç –Ω–∞ —Ä–∞–±–æ—Ç—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–ö–æ–¥:**

```typescript
// –°–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
localStorage.setItem('userName', name);

// –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î (–Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç)
saveUserName(name).catch(error => {
  console.error('Failed to sync name to database:', error);
});
```

### 5. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

**–ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è:**
- –í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞—Ç–µ–π –∞—Ä–∫–∞–Ω–æ–≤
- –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–µ—Ä–µ—Å—á–µ—Ç–∞ –≤ –ø–æ–ª–Ω–æ—á—å
- –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ API /api/user/profile
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–º Calculator

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:**
- React DevTools Profiler
- Chrome Performance tab
- Next.js Analytics
- Custom performance marks


## –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –∏ –º–∏–≥—Ä–∞—Ü–∏—è

### –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

**–°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ –≤ localStorage:**

–°—Ç–∞—Ä—ã–π —Ñ–æ—Ä–º–∞—Ç (–µ—Å–ª–∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç):
```javascript
localStorage.getItem('userName') // –°—Ç—Ä–æ–∫–∞
```

–ù–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç:
```javascript
localStorage.getItem('userName') // –°—Ç—Ä–æ–∫–∞ (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
localStorage.getItem('lastCalculationDate') // ISO —Å—Ç—Ä–æ–∫–∞ (–Ω–æ–≤–æ–µ)
localStorage.getItem('arcanaData') // JSON —Å—Ç—Ä–æ–∫–∞ (–Ω–æ–≤–æ–µ)
```

**–°—Ç—Ä–∞—Ç–µ–≥–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏:**
- –°—É—â–µ—Å—Ç–≤—É—é—â–µ–µ –ø–æ–ª–µ `userName` –æ—Å—Ç–∞–µ—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- –ù–æ–≤—ã–µ –ø–æ–ª—è –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º —Ä–∞—Å—á–µ—Ç–µ
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –Ω–æ–≤—ã—Ö –ø–æ–ª–µ–π –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç –æ—à–∏–±–æ–∫
- Graceful fallback –∫ –ø–µ—Ä–µ—Å—á–µ—Ç—É

### –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –∫–æ–¥–æ–º

**Calculator.tsx:**
- –°—É—â–µ—Å—Ç–≤—É—é—â–∞—è –ª–æ–≥–∏–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è
- –î–æ–±–∞–≤–ª—è—é—Ç—Å—è –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (–Ω–µ –ª–æ–º–∞—é—Ç —Å—Ç–∞—Ä—ã–µ)
- State —Ä–∞—Å—à–∏—Ä—è–µ—Ç—Å—è (–æ–±—Ä–∞—Ç–Ω–æ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ)

**CardOfDay.tsx:**
- –°—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ –∫–∞—Ä—Ç –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è
- –î–æ–±–∞–≤–ª—è–µ—Ç—Å—è –∑–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–µ–π (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è)
- –†–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ —Å—Ç–∞—Ç–µ–π (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç placeholder)

**arcanaCalculator.ts:**
- –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–µ –º–µ–Ω—è—é—Ç—Å—è
- –î–æ–±–∞–≤–ª—è–µ—Ç—Å—è –Ω–æ–≤—ã–π –º–æ–¥—É–ª—å serialization.ts
- –ù–µ—Ç breaking changes

### –ú–∏–≥—Ä–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

**User —Ç–∞–±–ª–∏—Ü–∞:**
- –ü–æ–ª–µ `name` —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –º–∏–≥—Ä–∞—Ü–∏–π –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è

**Article —Ç–∞–±–ª–∏—Ü–∞:**
- –¢–∞–±–ª–∏—Ü–∞ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- –î–æ–±–∞–≤–ª—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–∞–Ω–Ω—ã–µ (44 –∑–∞–ø–∏—Å–∏)
- SQL —Å–∫—Ä–∏–ø—Ç –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–µ–Ω (–º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ)

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏:**

```sql
-- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å—Ç–∞—Ç–µ–π –∞—Ä–∫–∞–Ω–æ–≤
SELECT COUNT(*) FROM "Article" 
WHERE category = 'Arcana (Cards)';
-- –û–∂–∏–¥–∞–µ—Ç—Å—è: 44

-- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
SELECT relatedValue, language, COUNT(*) 
FROM "Article" 
WHERE category = 'Arcana (Cards)'
GROUP BY relatedValue, language
ORDER BY relatedValue;
-- –û–∂–∏–¥–∞–µ—Ç—Å—è: 22 –ø–∞—Ä—ã (ru + en –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∞—Ä–∫–∞–Ω–∞)
```

### –û—Ç–∫–∞—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π

**–ï—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –æ—Ç–∫–∞—Ç:**

1. **–ö–æ–¥:**
   - –£–¥–∞–ª–∏—Ç—å –Ω–æ–≤—ã–µ —Ñ–∞–π–ª—ã (serialization.ts, useMidnightCheck.ts, profile/route.ts)
   - –û—Ç–∫–∞—Ç–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ Calculator.tsx –∏ CardOfDay.tsx —á–µ—Ä–µ–∑ git
   - –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

2. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:**
   - –°—Ç–∞—Ç—å–∏ –∞—Ä–∫–∞–Ω–æ–≤ –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å (–Ω–µ –≤–ª–∏—è—é—Ç –Ω–∞ —Ä–∞–±–æ—Ç—É)
   - –ò–ª–∏ —É–¥–∞–ª–∏—Ç—å: `DELETE FROM "Article" WHERE category = 'Arcana (Cards)';`

3. **localStorage:**
   - –°—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ (`userName`) –æ—Å—Ç–∞—é—Ç—Å—è —Ä–∞–±–æ—á–∏–º–∏
   - –ù–æ–≤—ã–µ –ø–æ–ª—è –º–æ–∂–Ω–æ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –∏–ª–∏ –æ—á–∏—Å—Ç–∏—Ç—å

**–†–∏—Å–∫–∏ –æ—Ç–∫–∞—Ç–∞:** –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ, —Ç–∞–∫ –∫–∞–∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∞–¥–¥–∏—Ç–∏–≤–Ω—ã–µ (–Ω–µ –ª–æ–º–∞—é—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å)


## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### –°–æ–±—ã—Ç–∏—è –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

#### 1. –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞—Ä–∫–∞–Ω–æ–≤

```typescript
// –£—Å–ø–µ—à–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
console.log('[Arcana] Midnight update triggered', {
  previousDate: lastCalculationDate,
  newDate: new Date().toISOString(),
  arcana: { morning, day, evening, night },
});

// –û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
console.error('[Arcana] Failed to recalculate at midnight', {
  error: error.message,
  lastCalculationDate,
});
```

#### 2. –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∏–º–µ–Ω–∏

```typescript
// –£—Å–ø–µ—à–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î
console.log('[Profile] Name saved to database', {
  userId: user.id,
  name: name,
});

// –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
console.error('[Profile] Failed to save name to database', {
  error: error.message,
  fallback: 'localStorage',
});

// –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑ –ë–î
console.log('[Profile] Name loaded from database', {
  userId: user.id,
  name: user.name,
});
```

#### 3. –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–µ–π

```typescript
// –£—Å–ø–µ—à–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞
console.log('[Articles] Loaded arcana articles', {
  arcanaNumbers: uniqueArcanas,
  count: Object.keys(loadedArticles).length,
  language: locale,
});

// –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∞—è —Å—Ç–∞—Ç—å—è
console.warn('[Articles] Article not found', {
  arcanaNumber: num,
  language: locale,
});

// –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏
console.error('[Articles] Failed to load article', {
  arcanaNumber: num,
  error: error.message,
});
```

#### 4. –ü–∞—Ä—Å–∏–Ω–≥ –¥–∞–Ω–Ω—ã—Ö

```typescript
// –û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞
console.error('[Serialization] Failed to parse arcana data', {
  error: result.error,
  jsonString: jsonString.substring(0, 100), // –ü–µ—Ä–≤—ã–µ 100 —Å–∏–º–≤–æ–ª–æ–≤
});
```

### –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

**Production –º–µ—Ç—Ä–∏–∫–∏:**

1. **–ß–∞—Å—Ç–æ—Ç–∞ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–π**
   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—Å–ø–µ—à–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –≤ –ø–æ–ª–Ω–æ—á—å
   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏
   - –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–µ—Ä–µ—Å—á–µ—Ç–∞

2. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ API /api/user/profile**
   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –¥–µ–Ω—å
   - –ü—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—à–Ω—ã—Ö/–Ω–µ—É—Å–ø–µ—à–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
   - –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞
   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ 401 –æ—à–∏–±–æ–∫ (–∏—Å—Ç–µ–∫—à–∏–µ —Å–µ—Å—Å–∏–∏)

3. **–ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–µ–π**
   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ /api/articles –¥–ª—è –∞—Ä–∫–∞–Ω–æ–≤
   - –ü—Ä–æ—Ü–µ–Ω—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö —Å—Ç–∞—Ç–µ–π
   - –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏
   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∞—Ä–∫–∞–Ω–æ–≤ –≤ –¥–µ–Ω—å

4. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ localStorage**
   - –ü—Ä–æ—Ü–µ–Ω—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
   - –ß–∞—Å—Ç–æ—Ç–∞ –æ—à–∏–±–æ–∫ –ø–∞—Ä—Å–∏–Ω–≥–∞
   - –†–∞–∑–º–µ—Ä —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### –ê–ª–µ—Ä—Ç—ã

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ:**
- –ë–æ–ª–µ–µ 10% –æ—à–∏–±–æ–∫ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –∏–º–µ–Ω–∏ –≤ –ë–î
- –ë–æ–ª–µ–µ 20% –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö —Å—Ç–∞—Ç–µ–π –∞—Ä–∫–∞–Ω–æ–≤
- API /api/user/profile –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –±–æ–ª–µ–µ 5 –º–∏–Ω—É—Ç

**–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è:**
- –ë–æ–ª–µ–µ 5% –æ—à–∏–±–æ–∫ –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ localStorage
- –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞—Ç–µ–π > 500ms
- –ë–æ–ª–µ–µ 100 –æ—à–∏–±–æ–∫ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤ –¥–µ–Ω—å

### –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

**Development:**
- Console.log –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
- React DevTools –¥–ª—è –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏—è
- Chrome DevTools Network tab

**Production:**
- Next.js Analytics
- Sentry –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –æ—à–∏–±–æ–∫
- Custom logging middleware
- Database query monitoring (Prisma)


## –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ useMidnightCheck hook

```typescript
import { useMidnightCheck } from '@/lib/hooks/useMidnightCheck';

function MyComponent() {
  const { lastCheckDate, isChecking } = useMidnightCheck({
    onMidnight: () => {
      console.log('Midnight reached!');
      // –í—ã–ø–æ–ª–Ω–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ —Å–º–µ–Ω–µ –¥–∞—Ç—ã
    },
    enabled: true, // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é true
    checkIntervalMs: 60000, // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 60000 (1 –º–∏–Ω—É—Ç–∞)
  });

  return <div>Last check: {lastCheckDate?.toISOString()}</div>;
}
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ serialization —É—Ç–∏–ª–∏—Ç

```typescript
import { 
  serializeArcanaData, 
  parseArcanaData, 
  formatArcanaForDisplay 
} from '@/lib/arcana/serialization';

// –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è
const arcana = { morning: 15, day: 8, evening: 12, night: 20 };
const jsonString = serializeArcanaData(arcana);
localStorage.setItem('arcanaData', jsonString);

// –î–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è
const stored = localStorage.getItem('arcanaData');
if (stored) {
  const result = parseArcanaData(stored);
  
  if (result.success) {
    console.log('Parsed arcana:', result.data);
  } else {
    console.error('Parse error:', result.error);
  }
}

// –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
const formatted = formatArcanaForDisplay(arcana, 'ru');
console.log(formatted.morning); // "–£—Ç—Ä–æ: –ê—Ä–∫–∞–Ω 15"
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ API endpoint

```typescript
// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
async function updateUserName(name: string) {
  try {
    const response = await fetch('/api/user/profile', {
      method: 'PUT',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({ name }),
    });

    if (!response.ok) {
      const error = await response.json();
      throw new Error(error.error);
    }

    const { user } = await response.json();
    return user;
  } catch (error) {
    console.error('Failed to update user name:', error);
    throw error;
  }
}
```

### –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–µ–π –∞—Ä–∫–∞–Ω–æ–≤

```typescript
// –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç—å–∏ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∞—Ä–∫–∞–Ω–∞
async function loadArcanaArticle(arcanaNumber: number, language: string) {
  try {
    const response = await fetch(
      `/api/articles?relatedValue=arcana_${arcanaNumber}&language=${language}`
    );

    if (!response.ok) {
      throw new Error(`HTTP ${response.status}`);
    }

    const { articles } = await response.json();
    
    if (articles && articles.length > 0) {
      return {
        title: articles[0].title,
        content: articles[0].content,
      };
    }

    return null;
  } catch (error) {
    console.error(`Failed to load article for arcana ${arcanaNumber}:`, error);
    return null;
  }
}
```

### –¢–∏–ø—ã TypeScript

```typescript
// –†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞—Å—á–µ—Ç–∞ –∞—Ä–∫–∞–Ω–æ–≤
interface DayCardResult {
  morning: number;   // 1-22
  day: number;       // 1-22
  evening: number;   // 1-22
  night: number;     // 1-22
}

// –†–µ–∑—É–ª—å—Ç–∞—Ç –ø–∞—Ä—Å–∏–Ω–≥–∞
interface ParseResult<T> {
  success: boolean;
  data?: T;
  error?: string;
}

// –°—Ç–∞—Ç—å—è –∞—Ä–∫–∞–Ω–∞
interface ArcanaArticle {
  title: string;
  content: string;
}

// –û–ø—Ü–∏–∏ –¥–ª—è useMidnightCheck
interface UseMidnightCheckOptions {
  onMidnight: () => void;
  enabled?: boolean;
  checkIntervalMs?: number;
}

// –í–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ useMidnightCheck
interface UseMidnightCheckReturn {
  lastCheckDate: Date | null;
  isChecking: boolean;
}
```

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

**–ü—Ä–∏–º–µ—Ä 1: –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª —Ä–∞–±–æ—Ç—ã —Å –∞—Ä–∫–∞–Ω–∞–º–∏**

```typescript
function ArcanaExample() {
  const [arcana, setArcana] = useState<DayCardResult | null>(null);

  // –†–∞—Å—á–µ—Ç –∞—Ä–∫–∞–Ω–æ–≤
  const calculateArcana = () => {
    const calculator = new ArcanaCalculator();
    const result = calculator.calculateDayCard(15, 32);
    
    // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
    const serialized = serializeArcanaData(result);
    localStorage.setItem('arcanaData', serialized);
    localStorage.setItem('lastCalculationDate', new Date().toISOString());
    
    setArcana(result);
  };

  // –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏
  useEffect(() => {
    const stored = localStorage.getItem('arcanaData');
    if (stored) {
      const parsed = parseArcanaData(stored);
      if (parsed.success) {
        setArcana(parsed.data);
      }
    }
  }, []);

  // –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤ –ø–æ–ª–Ω–æ—á—å
  useMidnightCheck({
    onMidnight: () => {
      if (arcana) {
        calculateArcana();
      }
    },
    enabled: !!arcana,
  });

  return <div>{/* –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –∞—Ä–∫–∞–Ω–æ–≤ */}</div>;
}
```

**–ü—Ä–∏–º–µ—Ä 2: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∏–º–µ–Ω–∏**

```typescript
function NameSyncExample() {
  const [name, setName] = useState('');

  // –ó–∞–≥—Ä—É–∑–∫–∞ –∏–º–µ–Ω–∏
  useEffect(() => {
    const loadName = async () => {
      // –ü–æ–ø—ã—Ç–∫–∞ –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ —Å–µ—Å—Å–∏–∏
      const response = await fetch('/api/auth/session?sessionId=...');
      if (response.ok) {
        const { user } = await response.json();
        setName(user.name);
        localStorage.setItem('userName', user.name);
      } else {
        // Fallback –∫ localStorage
        const stored = localStorage.getItem('userName');
        if (stored) setName(stored);
      }
    };

    loadName();
  }, []);

  // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–º–µ–Ω–∏
  const saveName = async (newName: string) => {
    setName(newName);
    localStorage.setItem('userName', newName);

    // –ü–æ–ø—ã—Ç–∫–∞ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –ë–î
    try {
      await fetch('/api/user/profile', {
        method: 'PUT',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ name: newName }),
      });
    } catch (error) {
      console.error('Failed to sync to database:', error);
    }
  };

  return <input value={name} onChange={(e) => saveName(e.target.value)} />;
}
```


## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–î–∞–Ω–Ω—ã–π –¥–∏–∑–∞–π–Ω –æ–ø–∏—Å—ã–≤–∞–µ—Ç –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã –∞—Ä–∫–∞–Ω–æ–≤ –Ω–∞ —Å–∞–π—Ç–µ fatos.pro. –û—Å–Ω–æ–≤–Ω—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è:

### –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

1. **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è**: –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç –∞—Ä–∫–∞–Ω—ã –≤ –ø–æ–ª–Ω–æ—á—å –±–µ–∑ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
2. **–ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è**: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —É–ª—É—á—à–∞–µ—Ç UX –∏ —Å–æ–∑–¥–∞–µ—Ç –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ–ø—ã—Ç
3. **–ë–æ–≥–∞—Ç—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç**: 44 —Å—Ç–∞—Ç—å–∏ –∞—Ä–∫–∞–Ω–æ–≤ (22 √ó 2 —è–∑—ã–∫–∞) –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç –≥–ª—É–±–æ–∫–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π
4. **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å**: –¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–∞—è —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

- **–ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å**: –ö–∞–∂–¥—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω –æ—Ç–¥–µ–ª—å–Ω–æ
- **–†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å**: –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç –±—ã—Å—Ç—Ä—É—é —Ä–∞–±–æ—Ç—É –±–µ–∑ –∑–∞–¥–µ—Ä–∂–µ–∫
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –≤—Å–µ—Ö —É—Ä–æ–≤–Ω—è—Ö –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç –∞—Ç–∞–∫ –∏ –æ—à–∏–±–æ–∫

### –ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞

- **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: –î–≤–æ–π–Ω–æ–π –ø–æ–¥—Ö–æ–¥ (unit + property-based) –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –≤—ã—Å–æ–∫–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ
- **–¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: TypeScript –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—é—Ç –æ—à–∏–±–∫–∏ —Ç–∏–ø–æ–≤
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**: Graceful degradation –ø—Ä–∏ –ª—é–±—ã—Ö —Å–±–æ—è—Ö
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: –ü–æ–¥—Ä–æ–±–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∏ –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. –£—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –¥–∏–∑–∞–π–Ω–∞ –∑–∞–∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞–Ω–Ω—ã–º–∏ —Å—Ç–æ—Ä–æ–Ω–∞–º–∏
2. –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á –≤ —Å–∏—Å—Ç–µ–º–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞–º–∏
3. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ —Ñ–∞–∑–∞–º (—Å–º. –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏)
4. –ö–æ–¥-—Ä–µ–≤—å—é –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
5. –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –≤ production
6. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ —Å–±–æ—Ä –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏

### –ö–æ–Ω—Ç–∞–∫—Ç—ã

–î–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ –ø–æ –¥–∏–∑–∞–π–Ω—É –∏–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –æ–±—Ä–∞—â–∞–π—Ç–µ—Å—å –∫ –∫–æ–º–∞–Ω–¥–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ fatos.pro.

---

**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞:** 1.0  
**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2024-01-15  
**–°—Ç–∞—Ç—É—Å:** –ì–æ—Ç–æ–≤ –∫ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—é

