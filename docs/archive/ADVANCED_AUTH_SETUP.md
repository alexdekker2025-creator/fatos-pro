# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

1. ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Å—Ö–µ–º–∞ Prisma (–¥–æ–±–∞–≤–ª–µ–Ω—ã 5 –Ω–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π)
2. ‚úÖ –°–æ–∑–¥–∞–Ω–∞ SQL –º–∏–≥—Ä–∞—Ü–∏—è
3. ‚úÖ –°–æ–∑–¥–∞–Ω—ã —Å–µ—Ä–≤–∏—Å—ã: EncryptionService, TokenService, EmailService
4. ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω package.json —Å –Ω–æ–≤—ã–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏
5. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ .env

## üìã –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –≤—Ä—É—á–Ω—É—é

### –®–∞–≥ 1: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–∞–∫–µ—Ç—ã ‚úÖ (–í–´–ü–û–õ–ù–ï–ù–û)

–ú–∏–≥—Ä–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –≤ Neon.

### –®–∞–≥ 2: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å npm –ø–∞–∫–µ—Ç—ã

–í—ã–ø–æ–ª–Ω–∏—Ç–µ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ:

```bash
npm install
```

–≠—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç:
- `resend` - –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ email
- `otplib` - –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ TOTP –∫–æ–¥–æ–≤ (2FA)
- `qrcode` - –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ QR –∫–æ–¥–æ–≤
- `oauth4webapi` - –¥–ª—è OAuth –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- `@types/qrcode` - TypeScript —Ç–∏–ø—ã

### –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Resend (–¥–ª—è email)

1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ [resend.com](https://resend.com)
2. –°–æ–∑–¥–∞–π—Ç–µ API –∫–ª—é—á
3. –û–±–Ω–æ–≤–∏—Ç–µ –≤ `.env`:
   ```
   RESEND_API_KEY="re_–≤–∞—à_–Ω–∞—Å—Ç–æ—è—â–∏–π_–∫–ª—é—á"
   ```

**–í–∞–∂–Ω–æ:** –ë–µ–∑ Resend API –∫–ª—é—á–∞ —Ñ—É–Ω–∫—Ü–∏–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø–∞—Ä–æ–ª—è –∏ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ email —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ –±—É–¥—É—Ç.

### –®–∞–≥ 4: –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å ENCRYPTION_SECRET

–î–ª—è production –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∑–∞–º–µ–Ω–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ `.env`:

```bash
# –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ —Å–ª—É—á–∞–π–Ω—É—é —Å—Ç—Ä–æ–∫—É (–º–∏–Ω–∏–º—É–º 32 —Å–∏–º–≤–æ–ª–∞)
node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
```

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏ –∑–∞–º–µ–Ω–∏—Ç–µ –≤ `.env`:
```
ENCRYPTION_SECRET="–≤–∞—à_—Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π_–∫–ª—é—á"
```

### –®–∞–≥ 5: –û–±–Ω–æ–≤–∏—Ç—å Prisma Client

```bash
npx prisma generate
```

–ò–ª–∏ —á–µ—Ä–µ–∑ npm script:
```bash
npm run db:generate
```

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —à–∞–≥–æ–≤ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

1. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –Ω–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã —Å–æ–∑–¥–∞–Ω—ã –≤ Neon
   - PasswordResetToken
   - EmailVerificationToken
   - TwoFactorAuth
   - OAuthProvider
   - SecurityLog

2. **–ü–∞–∫–µ—Ç—ã**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—Å–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ
   ```bash
   npm list resend otplib qrcode oauth4webapi
   ```

3. **–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `.env`
   - ENCRYPTION_SECRET (–º–∏–Ω–∏–º—É–º 32 —Å–∏–º–≤–æ–ª–∞)
   - RESEND_API_KEY (–Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å "re_")
   - NEXT_PUBLIC_BASE_URL (–≤–∞—à URL)

## üìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –º–æ–∂–Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é:

1. ‚úÖ TwoFactorService (TOTP, QR –∫–æ–¥—ã, backup –∫–æ–¥—ã)
2. ‚úÖ OAuthService (Google, Facebook –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è)
3. ‚úÖ API endpoints (password reset, email verification, 2FA, OAuth)
4. ‚úÖ Frontend –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
5. ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

## üö® –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

- **ENCRYPTION_SECRET** - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–µ–Ω –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏. –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∫–æ–º–º–∏—Ç—å—Ç–µ —Ä–µ–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ Git
- **RESEND_API_KEY** - –Ω–µ–æ–±—Ö–æ–¥–∏–º –¥–ª—è —Ä–∞–±–æ—Ç—ã email —Ñ—É–Ω–∫—Ü–∏–π
- OAuth –∫–ª—é—á–∏ (Google/Facebook) - –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã, –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–∑–∂–µ
- –í—Å–µ —Ç–æ–∫–µ–Ω—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –≤–∏–¥–µ —Ö–µ—à–µ–π (SHA-256)
- OAuth —Ç–æ–∫–µ–Ω—ã –∏ TOTP —Å–µ–∫—Ä–µ—Ç—ã —à–∏—Ñ—Ä—É—é—Ç—Å—è (AES-256-GCM)

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [Resend Docs](https://resend.com/docs)
- [otplib Docs](https://github.com/yeojz/otplib)
- [oauth4webapi Docs](https://github.com/panva/oauth4webapi)
